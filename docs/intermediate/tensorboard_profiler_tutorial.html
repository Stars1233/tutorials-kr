
<!DOCTYPE html>


<html lang="ko" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2022-11-30T07:09:41+00:00" /><meta property="og:title" content="텐서보드를 이용한 파이토치 프로파일러" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tutorials.pytorch.kr/intermediate/tensorboard_profiler_tutorial.html" />
<meta property="og:site_name" content="PyTorch Tutorials KR" />
<meta property="og:description" content="번역: 손동우 이 튜토리얼에서는 파이토치(PyTorch) 프로파일러(profiler)와 함께 텐서보드(TensorBoard) 플러그인(plugin)을 사용하여 모델의 성능 병목 현상을 탐지하는 방법을 보여 줍니다. 소개: 파이토치(PyTorch) 1.8부터 GPU에서 CUDA 커널(kernel) 실행 뿐만 아니라 CPU 작업을 기록할 수 있는 업데이트된 프로파일러 API가 포함되어 있습니다. 프로파일러는 텐서보드 플러그인에서 이런 정보를 시각화하고 성능 병목 현상에 대한 분석을 제공할 수 있습니다. 이 튜토리얼에서는 간단한 R..." />
<meta property="og:image" content="https://tutorials.pytorch.kr/_static/logos/logo-kr-sm-dark.png" />
<meta property="og:image:alt" content="PyTorch Tutorials KR" />
<meta name="description" content="번역: 손동우 이 튜토리얼에서는 파이토치(PyTorch) 프로파일러(profiler)와 함께 텐서보드(TensorBoard) 플러그인(plugin)을 사용하여 모델의 성능 병목 현상을 탐지하는 방법을 보여 줍니다. 소개: 파이토치(PyTorch) 1.8부터 GPU에서 CUDA 커널(kernel) 실행 뿐만 아니라 CPU 작업을 기록할 수 있는 업데이트된 프로파일러 API가 포함되어 있습니다. 프로파일러는 텐서보드 플러그인에서 이런 정보를 시각화하고 성능 병목 현상에 대한 분석을 제공할 수 있습니다. 이 튜토리얼에서는 간단한 R..." />
<meta property="og:ignore_canonical" content="true" />

    <title>텐서보드를 이용한 파이토치 프로파일러 &#8212; 파이토치 한국어 튜토리얼 (PyTorch tutorials in Korean)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=536c50fe" />
    <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=4d2595e5" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pytorch_theme.css?v=c326296f" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=097efa9c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom2.css?v=b169ea90" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=725a5b95"></script>
    <script src="../_static/doctools.js?v=92e14aea"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/translations.js?v=b5f768d8"></script>
    <script src="../_static/katex.min.js?v=be8ff15f"></script>
    <script src="../_static/auto-render.min.js?v=ad136472"></script>
    <script src="../_static/katex_autorenderer.js?v=bebc588a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intermediate/tensorboard_profiler_tutorial';</script>
    <link rel="canonical" href="https://tutorials.pytorch.kr/intermediate/tensorboard_profiler_tutorial.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="색인" href="../genindex.html" />
    <link rel="search" title="검색" href="../search.html" />
    <link rel="next" title="Raspberry Pi 4 에서 실시간 추론(Inference) (30fps!)" href="realtime_rpi.html" />
    <link rel="prev" title="Multi-Objective NAS with Ax" href="ax_multiobjective_nas_tutorial.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ko"/>
    <meta name="docbuild:last-update" content="2022년 11월 30일"/>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
<script>
  if (window.location.hostname === 'docs.pytorch.org' || window.location.hostname === 'docs-preview.pytorch.org') {
    const script = document.createElement('script');
    script.src = 'https://cmp.osano.com/16A0DbT9yDNIaQkvZ/31b1b91a-e0b6-47ea-bde2-7f2bd13dbe5c/osano.js?variant=one';
    document.head.appendChild(script);
  }
</script>
<script>
  // Cookie banner for non-LF projects
  document.addEventListener('DOMContentLoaded', function () {
    // Hide cookie banner on local environments and LF owned docs
    if (window.location.hostname === 'localhost' ||
      window.location.hostname === '0.0.0.0' ||
      window.location.hostname === '127.0.0.1' ||
      window.location.hostname === 'docs.pytorch.org' ||
      window.location.hostname === 'docs-preview.pytorch.org' ||
      window.location.hostname.startsWith('192.168.')) {
      const banner = document.querySelector('.cookie-banner-wrapper');
      if (banner) {
        banner.style.display = 'none';
      }
    }
  });
</script>
<!-- Conditional CSS for header and footer height adjustment -->

<link rel="stylesheet" type="text/css" href="../_static/css/theme.css" crossorigin="anonymous">
<script type="text/javascript" src="../_static/js/theme.js"></script>
<script type="text/javascript" src="../_static/js/dropdown-menu.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&family=Nanum+Gothic+Coding:wght@400;700&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">
<meta property="og:image" content="../_static/img/pytorch_seo.png" />
<link rel="stylesheet" href="../_static/webfonts/all.min.css" crossorigin="anonymous">
<meta http-equiv="Content-Security-Policy"
  content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval' blob:;">
<meta name="pytorch_project" content="tutorials">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-LZRD6GXDLF" height="0" width="0"
    style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- Google Tag Manager -->
<script>(function (w, d, s, l, i) {
    w[l] = w[l] || []; w[l].push({
      'gtm.start':
        new Date().getTime(), event: 'gtm.js'
    }); var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
        'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    j.onload = function () {
      window.dispatchEvent(new Event('gtm_loaded'));
      console.log('GTM loaded successfully');
    };
  })(window, document, 'script', 'dataLayer', 'G-LZRD6GXDLF');
</script>
<!-- End Google Tag Manager -->
<!-- Facebook Pixel Code -->
<script>
  !function (f, b, e, v, n, t, s) {
    if (f.fbq) return; n = f.fbq = function () {
      n.callMethod ?
        n.callMethod.apply(n, arguments) : n.queue.push(arguments)
    };
    if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
    n.queue = []; t = b.createElement(e); t.async = !0;
    t.src = v; s = b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t, s)
  }(window, document, 'script',
    'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '243028289693773');
  fbq('track', 'PageView');
</script>
<script>
  document.documentElement.setAttribute('data-version', 'v2.8.0+cu128');
</script>
<noscript>
  <img height="1" width="1" src="https://www.facebook.com/tr?id=243028289693773&ev=PageView&noscript=1" />
</noscript>
<script>
  function gtag() {
    window.dataLayer.push(arguments);
  }
</script>
<!-- End Facebook Pixel Code -->
<!-- Script to Fix scrolling -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Fix anchor scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);

        if (targetElement) {
          const headerHeight =
            (document.querySelector('.header-holder') ? document.querySelector('.header-holder').offsetHeight : 0) +
            (document.querySelector('.bd-header') ? document.querySelector('.bd-header').offsetHeight : 0) + 20;

          const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerHeight;
          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });

          // Update URL hash without scrolling
          history.pushState(null, null, '#' + targetId);
        }
      });
    });
  });
</script>

<script async src="https://cse.google.com/cse.js?cx=e65585f8c3ea1440e"></script>


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ko"/>
    <meta name="docbuild:last-update" content="2022년 11월 30일"/>

  </head>

<body data-feedback-url="https://github.com/PyTorchKorea/tutorials-kr" class="pytorch-body">
  
    <div class="container-fluid header-holder tutorials-header" id="header-holder">
   <div class="header-container-wrapper">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.kr/" aria-label="PyTorchKR"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="learnDropdownButton" data-toggle="learn-dropdown" class="learn-dropdown">
              <a class="with-down-arrow">
                <span>배우기</span>
              </a>
              <div class="learn-dropdown-menu dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.kr/get-started/locally/">
                  <span class="dropdown-title">PyTorch 시작하기</span>
                </a>
                <a class="nav-dropdown-item" href="https://tutorials.pytorch.kr/beginner/basics/intro.html">
                  <span class="dropdown-title">기본 익히기</span>
                </a>
                <a class="nav-dropdown-item" href="https://tutorials.pytorch.kr/" target="_self">
                  <span class="dropdown-title">한국어 튜토리얼</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.kr/hub/">
                  <span class="dropdown-title">한국어 모델 허브</span>
                </a>
                <a class="nav-dropdown-item" href="https://docs.pytorch.org/tutorials/" target="_blank">
                  <span class="dropdown-title">Official Tutorials</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <a href="https://pytorch.kr/blog/">
              <span>블로그</span>
            </a>
          </li>

          <li class="main-menu-item">
          <div id="docsDropdownButton" data-toggle="docs-dropdown" class="docs-dropdown">
              <a class="with-down-arrow">
              <span>문서</span>
              </a>
              <div class="docs-dropdown-menu dropdown-menu">
                <a class="nav-dropdown-item" href="https://docs.pytorch.org/docs/" target="_blank">
                  <span class="dropdown-title">PyTorch API</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.kr/domains/">
                  <span class="dropdown-title">Domain API 소개</span>
                </a>
                <a class="nav-dropdown-item" href="https://tutorials.pytorch.kr/" target="_self">
                  <span class="dropdown-title">한국어 튜토리얼</span>
                </a>
                <a class="nav-dropdown-item" href="https://docs.pytorch.org/tutorials/" target="_blank">
                  <span class="dropdown-title">Official Tutorials</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
          <div id="communityDropdownButton" data-toggle="community-dropdown" class="community-dropdown">
              <a class="with-down-arrow">
              <span>커뮤니티</span>
              </a>
              <div class="community-dropdown-menu dropdown-menu">
                <a class="nav-dropdown-item" href="https://discuss.pytorch.kr/" target="_self">
                  <span class="dropdown-title">한국어 커뮤니티</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.kr/resources/">
                  <span class="dropdown-title">개발자 정보</span>
                </a>
                <a class="nav-dropdown-item" href="https://landscape.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Landscape</span>
                </a>
              </div>
            </div>
          </li>

        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu">
        <i class="fa-solid fa-ellipsis"></i>
      </a>
    </div>
  </div>
 </div>

 <!-- Begin Mobile Menu -->

<div class="mobile-main-menu">
  <div class="container-fluid">
    <div class="header-container-wrapper">
      <div class="mobile-main-menu-header-container">
        <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu">
          <i class="fa-solid fa-xmark"></i>
        </a>
      </div>
    </div>
  </div>

  <div class="mobile-main-menu-links-container">
    <div class="main-menu">
      <ul>
         <li class="resources-mobile-menu-title">
           <a>배우기</a>
         </li>
         <ul class="resources-mobile-menu-items">
           <li>
             <a href="https://pytorch.kr/get-started/locally/">PyTorch 시작하기</a>
           </li>
           <li>
             <a href="https://tutorials.pytorch.kr/beginner/basics/intro.html">기본 익히기</a>
           </li>
           <li>
             <a href="https://tutorials.pytorch.kr/">한국어 튜토리얼</a>
           </li>
           <li>
             <a href="https://pytorch.kr/hub/">한국어 모델 허브</a>
           </li>
           <li>
             <a href="https://docs.pytorch.org/tutorials/" target="_blank">Official Tutorials</a>
           </li>
        </ul>
         <li class="resources-mobile-menu-title">
           <a href="https://pytorch.kr/blog/">블로그</a>
         </li>
         <li class="resources-mobile-menu-title">
           <a>문서</a>
         </li>
         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://docs.pytorch.org/docs/" target="_blank">PyTorch API</a>
          </li>
          <li>
            <a href="https://pytorch.kr/domains/">Domain API 소개</a>
          </li>
          <li>
            <a href="https://tutorials.pytorch.kr/">한국어 튜토리얼</a>
          </li>
          <li>
            <a href="https://docs.pytorch.org/tutorials/" target="_blank">Official Tutorials</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>커뮤니티</a>
        </li>
         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://discuss.pytorch.kr/">한국어 커뮤니티</a>
          </li>
          <li>
            <a href="https://pytorch.kr/resources/">개발자 정보</a>
          </li>
          <li>
            <a href="https://landscape.pytorch.org/" target="_blank">Landscape</a>
          </li>
        </ul>
      </ul>
    </div>
  </div>
</div>

<!-- End Mobile Menu -->
  
  
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">
  <a href="../index.html" class="version">v2.8.0+cu128</a>
</div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro.html">
    Intro
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../compilers_index.html">
    Compilers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../domains.html">
    Domains
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../distributed.html">
    Distributed
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../deep-dive.html">
    Deep Dive
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../extension.html">
    Extension
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../ecosystem.html">
    Ecosystem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../recipes_index.html">
    Recipes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<div class="search-container-wrapper">
  <div id="sphinx-search" class="search-container">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </div>

  <div id="google-search" class="search-container" style="display:none;">
    <div class="gcse-search-wrapper">
      <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
      <div class="gcse-search"></div>
    </div>
  </div>

  <div class="search-toggle-container" data-bs-title="Google Search Off" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <div class="search-toggle-inner">
      <label class="switch">
        <input type="checkbox" id="search-toggle">
        <span class="slider round"></span>
      </label>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
  // Define the search callback
  const myWebSearchStartingCallback = (gname, query) => {
    if (typeof dataLayer !== 'undefined' && query) {
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        'event': 'google_search',
        'search_term': query,
        'event_category': 'Search',
        'event_label': 'Google Search'
      });
    }
    return '';
  };

  // Set up the GCSE search callbacks
  window.__gcse || (window.__gcse = {});
  window.__gcse.searchCallbacks = {
    web: { starting: myWebSearchStartingCallback }
  };

  if (window.location.pathname.includes('/search.html')) {
    document.body.classList.add('search-page');
  }

  // Function to reinitialize Google CSE
  function reinitializeGoogleSearch() {
    if (window.__gcse && window.__gcse.initializationCallback) {
      window.__gcse.initializationCallback();
    }
  }

  // Function to handle search toggle
  function handleSearchToggle(toggle, sphinxSearch, googleSearch) {
    if (!toggle || !sphinxSearch || !googleSearch) return;

    // Check if the URL contains /stable/ or /tutorials/
    const currentUrl = window.location.href;
    // TODO: We've had reports that the google programmable search is returning stale documentation,
    //       Simple reproduction is to turn google search on and search for multinomial which will
    //       result in returning 1.8.1 documentation.
    //       We should turn this back on when we resolve that bug.
    const shouldDefaultToGoogle = false;
    const savedPreference = localStorage.getItem('searchPreference');

    // Set initial state
    if (savedPreference === 'google' || (savedPreference === null && shouldDefaultToGoogle)) {
      toggle.checked = true;
      sphinxSearch.style.display = 'none';
      googleSearch.style.display = 'block';
      if (savedPreference === null) {
        localStorage.setItem('searchPreference', 'google');
      }
      reinitializeGoogleSearch();
    } else {
      toggle.checked = false;
      sphinxSearch.style.display = 'block';
      googleSearch.style.display = 'none';
    }

    // Update tooltip
    updateTooltip(toggle.checked);

    // Skip if already initialized
    if (toggle.hasAttribute('data-initialized')) return;
    toggle.setAttribute('data-initialized', 'true');

    toggle.addEventListener('change', function() {
      if (this.checked) {
        sphinxSearch.style.display = 'none';
        googleSearch.style.display = 'block';
        localStorage.setItem('searchPreference', 'google');
        reinitializeGoogleSearch();
        trackSearchEngineSwitch('Google');
      } else {
        sphinxSearch.style.display = 'block';
        googleSearch.style.display = 'none';
        localStorage.setItem('searchPreference', 'sphinx');
        trackSearchEngineSwitch('Sphinx');
      }

      updateTooltip(this.checked);
      updateMobileSearch();
    });
  }

  // Update tooltip based on toggle state
  function updateTooltip(isChecked) {
    const tooltipElement = document.querySelector('.search-toggle-container');
    if (!tooltipElement) return;

    tooltipElement.setAttribute('data-bs-title', isChecked ? 'Google Search On' : 'Google Search Off');

    if (bootstrap && bootstrap.Tooltip) {
      const tooltipInstance = bootstrap.Tooltip.getInstance(tooltipElement);
      if (tooltipInstance) tooltipInstance.dispose();
      new bootstrap.Tooltip(tooltipElement);
    }
  }

  // Track search engine switch
  function trackSearchEngineSwitch(engine) {
    if (typeof dataLayer !== 'undefined') {
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        'event': 'search_engine_switch',
        'event_category': 'Search',
        'event_label': engine
      });
    }
  }

  // Function to update mobile search based on current toggle state
  function updateMobileSearch() {
    const toggle = document.getElementById('search-toggle');
    if (!toggle) return;

    const mobileSearchContainer = document.querySelector('.sidebar-header-items__end .navbar-item .search-container-wrapper');
    if (!mobileSearchContainer) return;

    const mobileSphinxSearch = mobileSearchContainer.querySelector('#sphinx-search');
    const mobileGoogleSearch = mobileSearchContainer.querySelector('#google-search');

    if (mobileSphinxSearch && mobileGoogleSearch) {
      mobileSphinxSearch.style.display = toggle.checked ? 'none' : 'block';
      mobileGoogleSearch.style.display = toggle.checked ? 'block' : 'none';

      if (toggle.checked) {
        reinitializeGoogleSearch();
      }
    }
  }

  // Initialize desktop search toggle
  const toggle = document.getElementById('search-toggle');
  const sphinxSearch = document.getElementById('sphinx-search');
  const googleSearch = document.getElementById('google-search');
  handleSearchToggle(toggle, sphinxSearch, googleSearch);

  // Set placeholder text for Google search input
  const observer = new MutationObserver(function() {
    document.querySelectorAll('.gsc-input input').forEach(input => {
      if (input && !input.hasAttribute('data-placeholder-set')) {
        input.setAttribute('placeholder', 'Search the docs ...');
        input.setAttribute('data-placeholder-set', 'true');
      }
    });
  });

  observer.observe(document.body, { childList: true, subtree: true });

  // Fix for scroll jump issue - improved approach
  function setupSearchInputHandlers(input) {
    if (input.hasAttribute('data-scroll-fixed')) return;
    input.setAttribute('data-scroll-fixed', 'true');

    let lastScrollPosition = 0;
    let isTyping = false;
    let scrollTimeout;

    // Save position before typing starts
    input.addEventListener('keydown', () => {
      lastScrollPosition = window.scrollY;
      isTyping = true;

      // Reset typing state after a short delay
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        isTyping = false;
      }, 100);
    });

    // Only maintain scroll position during typing
    function maintainScroll() {
      if (document.activeElement === input && isTyping) {
        window.scrollTo(0, lastScrollPosition);
        requestAnimationFrame(maintainScroll);
      }
    }

    input.addEventListener('focus', () => {
      // Just store initial position but don't force it
      lastScrollPosition = window.scrollY;
    });

    input.addEventListener('input', () => {
      isTyping = true;
      window.scrollTo(0, lastScrollPosition);

      // Reset typing state after a short delay
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        isTyping = false;
      }, 100);

      requestAnimationFrame(maintainScroll);
    });
  }

  // Apply to all search inputs and observe for new ones
  function applyToSearchInputs() {
    document.querySelectorAll('.search-container input, .gsc-input input').forEach(setupSearchInputHandlers);
  }

  applyToSearchInputs();

  const searchObserver = new MutationObserver(applyToSearchInputs);
  searchObserver.observe(document.body, { childList: true, subtree: true });

  // Watch for mobile menu creation
  const mobileMenuObserver = new MutationObserver(function(mutations) {
    for (const mutation of mutations) {
      if (!mutation.addedNodes.length) continue;

      // Style mobile search inputs
      document.querySelectorAll('.sidebar-header-items__end .navbar-item .search-container-wrapper .gsc-input input').forEach(input => {
        if (input) {
          input.setAttribute('placeholder', 'Search the docs ...');
          input.style.paddingLeft = '36px';
        }
      });

      // Check for mobile search container
      const mobileSearchContainer = document.querySelector('.sidebar-header-items__end .navbar-item .search-container-wrapper');
      if (!mobileSearchContainer) continue;

      const mobileToggle = mobileSearchContainer.querySelector('#search-toggle');
      if (mobileToggle && toggle) {
        // Sync mobile toggle with desktop toggle
        mobileToggle.checked = toggle.checked;
        updateMobileSearch();

        // Add event listener to mobile toggle if not already added
        if (!mobileToggle.hasAttribute('data-initialized')) {
          mobileToggle.setAttribute('data-initialized', 'true');
          mobileToggle.addEventListener('change', function() {
            // Sync desktop toggle with mobile toggle
            toggle.checked = this.checked;
            // Trigger change event on desktop toggle to update both
            toggle.dispatchEvent(new Event('change'));
          });
        }
      }
    }
  });

  mobileMenuObserver.observe(document.body, { childList: true, subtree: true });

  // Ensure Google CSE is properly loaded
  if (window.__gcse) {
    window.__gcse.callback = function() {
      // This will run after Google CSE is fully loaded
      if (toggle && toggle.checked) {
        reinitializeGoogleSearch();
      }
    };
  } else {
    window.__gcse = {
      callback: function() {
        if (toggle && toggle.checked) {
          reinitializeGoogleSearch();
        }
      }
    };
  }
});
</script>
</div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/PyTorchKorea/tutorials-kr" title="한국어 튜토리얼 GitHub 저장소" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">한국어 튜토리얼 GitHub 저장소</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.kr/" title="파이토치 한국어 커뮤니티" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">파이토치 한국어 커뮤니티</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro.html">
    Intro
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../compilers_index.html">
    Compilers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../domains.html">
    Domains
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../distributed.html">
    Distributed
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../deep-dive.html">
    Deep Dive
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../extension.html">
    Extension
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../ecosystem.html">
    Ecosystem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../recipes_index.html">
    Recipes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="search-container-wrapper">
  <div id="sphinx-search" class="search-container">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </div>

  <div id="google-search" class="search-container" style="display:none;">
    <div class="gcse-search-wrapper">
      <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
      <div class="gcse-search"></div>
    </div>
  </div>

  <div class="search-toggle-container" data-bs-title="Google Search Off" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <div class="search-toggle-inner">
      <label class="switch">
        <input type="checkbox" id="search-toggle">
        <span class="slider round"></span>
      </label>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
  // Define the search callback
  const myWebSearchStartingCallback = (gname, query) => {
    if (typeof dataLayer !== 'undefined' && query) {
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        'event': 'google_search',
        'search_term': query,
        'event_category': 'Search',
        'event_label': 'Google Search'
      });
    }
    return '';
  };

  // Set up the GCSE search callbacks
  window.__gcse || (window.__gcse = {});
  window.__gcse.searchCallbacks = {
    web: { starting: myWebSearchStartingCallback }
  };

  if (window.location.pathname.includes('/search.html')) {
    document.body.classList.add('search-page');
  }

  // Function to reinitialize Google CSE
  function reinitializeGoogleSearch() {
    if (window.__gcse && window.__gcse.initializationCallback) {
      window.__gcse.initializationCallback();
    }
  }

  // Function to handle search toggle
  function handleSearchToggle(toggle, sphinxSearch, googleSearch) {
    if (!toggle || !sphinxSearch || !googleSearch) return;

    // Check if the URL contains /stable/ or /tutorials/
    const currentUrl = window.location.href;
    // TODO: We've had reports that the google programmable search is returning stale documentation,
    //       Simple reproduction is to turn google search on and search for multinomial which will
    //       result in returning 1.8.1 documentation.
    //       We should turn this back on when we resolve that bug.
    const shouldDefaultToGoogle = false;
    const savedPreference = localStorage.getItem('searchPreference');

    // Set initial state
    if (savedPreference === 'google' || (savedPreference === null && shouldDefaultToGoogle)) {
      toggle.checked = true;
      sphinxSearch.style.display = 'none';
      googleSearch.style.display = 'block';
      if (savedPreference === null) {
        localStorage.setItem('searchPreference', 'google');
      }
      reinitializeGoogleSearch();
    } else {
      toggle.checked = false;
      sphinxSearch.style.display = 'block';
      googleSearch.style.display = 'none';
    }

    // Update tooltip
    updateTooltip(toggle.checked);

    // Skip if already initialized
    if (toggle.hasAttribute('data-initialized')) return;
    toggle.setAttribute('data-initialized', 'true');

    toggle.addEventListener('change', function() {
      if (this.checked) {
        sphinxSearch.style.display = 'none';
        googleSearch.style.display = 'block';
        localStorage.setItem('searchPreference', 'google');
        reinitializeGoogleSearch();
        trackSearchEngineSwitch('Google');
      } else {
        sphinxSearch.style.display = 'block';
        googleSearch.style.display = 'none';
        localStorage.setItem('searchPreference', 'sphinx');
        trackSearchEngineSwitch('Sphinx');
      }

      updateTooltip(this.checked);
      updateMobileSearch();
    });
  }

  // Update tooltip based on toggle state
  function updateTooltip(isChecked) {
    const tooltipElement = document.querySelector('.search-toggle-container');
    if (!tooltipElement) return;

    tooltipElement.setAttribute('data-bs-title', isChecked ? 'Google Search On' : 'Google Search Off');

    if (bootstrap && bootstrap.Tooltip) {
      const tooltipInstance = bootstrap.Tooltip.getInstance(tooltipElement);
      if (tooltipInstance) tooltipInstance.dispose();
      new bootstrap.Tooltip(tooltipElement);
    }
  }

  // Track search engine switch
  function trackSearchEngineSwitch(engine) {
    if (typeof dataLayer !== 'undefined') {
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        'event': 'search_engine_switch',
        'event_category': 'Search',
        'event_label': engine
      });
    }
  }

  // Function to update mobile search based on current toggle state
  function updateMobileSearch() {
    const toggle = document.getElementById('search-toggle');
    if (!toggle) return;

    const mobileSearchContainer = document.querySelector('.sidebar-header-items__end .navbar-item .search-container-wrapper');
    if (!mobileSearchContainer) return;

    const mobileSphinxSearch = mobileSearchContainer.querySelector('#sphinx-search');
    const mobileGoogleSearch = mobileSearchContainer.querySelector('#google-search');

    if (mobileSphinxSearch && mobileGoogleSearch) {
      mobileSphinxSearch.style.display = toggle.checked ? 'none' : 'block';
      mobileGoogleSearch.style.display = toggle.checked ? 'block' : 'none';

      if (toggle.checked) {
        reinitializeGoogleSearch();
      }
    }
  }

  // Initialize desktop search toggle
  const toggle = document.getElementById('search-toggle');
  const sphinxSearch = document.getElementById('sphinx-search');
  const googleSearch = document.getElementById('google-search');
  handleSearchToggle(toggle, sphinxSearch, googleSearch);

  // Set placeholder text for Google search input
  const observer = new MutationObserver(function() {
    document.querySelectorAll('.gsc-input input').forEach(input => {
      if (input && !input.hasAttribute('data-placeholder-set')) {
        input.setAttribute('placeholder', 'Search the docs ...');
        input.setAttribute('data-placeholder-set', 'true');
      }
    });
  });

  observer.observe(document.body, { childList: true, subtree: true });

  // Fix for scroll jump issue - improved approach
  function setupSearchInputHandlers(input) {
    if (input.hasAttribute('data-scroll-fixed')) return;
    input.setAttribute('data-scroll-fixed', 'true');

    let lastScrollPosition = 0;
    let isTyping = false;
    let scrollTimeout;

    // Save position before typing starts
    input.addEventListener('keydown', () => {
      lastScrollPosition = window.scrollY;
      isTyping = true;

      // Reset typing state after a short delay
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        isTyping = false;
      }, 100);
    });

    // Only maintain scroll position during typing
    function maintainScroll() {
      if (document.activeElement === input && isTyping) {
        window.scrollTo(0, lastScrollPosition);
        requestAnimationFrame(maintainScroll);
      }
    }

    input.addEventListener('focus', () => {
      // Just store initial position but don't force it
      lastScrollPosition = window.scrollY;
    });

    input.addEventListener('input', () => {
      isTyping = true;
      window.scrollTo(0, lastScrollPosition);

      // Reset typing state after a short delay
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        isTyping = false;
      }, 100);

      requestAnimationFrame(maintainScroll);
    });
  }

  // Apply to all search inputs and observe for new ones
  function applyToSearchInputs() {
    document.querySelectorAll('.search-container input, .gsc-input input').forEach(setupSearchInputHandlers);
  }

  applyToSearchInputs();

  const searchObserver = new MutationObserver(applyToSearchInputs);
  searchObserver.observe(document.body, { childList: true, subtree: true });

  // Watch for mobile menu creation
  const mobileMenuObserver = new MutationObserver(function(mutations) {
    for (const mutation of mutations) {
      if (!mutation.addedNodes.length) continue;

      // Style mobile search inputs
      document.querySelectorAll('.sidebar-header-items__end .navbar-item .search-container-wrapper .gsc-input input').forEach(input => {
        if (input) {
          input.setAttribute('placeholder', 'Search the docs ...');
          input.style.paddingLeft = '36px';
        }
      });

      // Check for mobile search container
      const mobileSearchContainer = document.querySelector('.sidebar-header-items__end .navbar-item .search-container-wrapper');
      if (!mobileSearchContainer) continue;

      const mobileToggle = mobileSearchContainer.querySelector('#search-toggle');
      if (mobileToggle && toggle) {
        // Sync mobile toggle with desktop toggle
        mobileToggle.checked = toggle.checked;
        updateMobileSearch();

        // Add event listener to mobile toggle if not already added
        if (!mobileToggle.hasAttribute('data-initialized')) {
          mobileToggle.setAttribute('data-initialized', 'true');
          mobileToggle.addEventListener('change', function() {
            // Sync desktop toggle with mobile toggle
            toggle.checked = this.checked;
            // Trigger change event on desktop toggle to update both
            toggle.dispatchEvent(new Event('change'));
          });
        }
      }
    }
  });

  mobileMenuObserver.observe(document.body, { childList: true, subtree: true });

  // Ensure Google CSE is properly loaded
  if (window.__gcse) {
    window.__gcse.callback = function() {
      // This will run after Google CSE is fully loaded
      if (toggle && toggle.checked) {
        reinitializeGoogleSearch();
      }
    };
  } else {
    window.__gcse = {
      callback: function() {
        if (toggle && toggle.checked) {
          reinitializeGoogleSearch();
        }
      }
    };
  }
});
</script>
</div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/PyTorchKorea/tutorials-kr" title="한국어 튜토리얼 GitHub 저장소" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">한국어 튜토리얼 GitHub 저장소</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.kr/" title="파이토치 한국어 커뮤니티" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">파이토치 한국어 커뮤니티</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../beginner/hyperparameter_tuning_tutorial.html">Ray Tune을 사용한 하이퍼파라미터 튜닝</a></li>
<li class="toctree-l1"><a class="reference internal" href="ax_multiobjective_nas_tutorial.html">Multi-Objective NAS with Ax</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">텐서보드를 이용한 파이토치 프로파일러</a></li>
<li class="toctree-l1"><a class="reference internal" href="realtime_rpi.html">Raspberry Pi 4 에서 실시간 추론(Inference) (30fps!)</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../ecosystem.html" class="nav-link">Ecosystem</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">텐서보드를 이용한 파이토치 프로파일러</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>
</div>
      
    </div>
  
</div>
</div>
              
              
  
<div id="searchbox"></div>
  <article class="bd-article" id="pytorch-article">
    <!-- Hidden breadcrumb schema for SEO only -->
    <div style="display:none;" itemscope itemtype="https://schema.org/BreadcrumbList">
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <link itemprop="item" href="../ecosystem.html">
        <meta itemprop="name" content="Ecosystem">
        <meta itemprop="position" content="1">
      </div>
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <meta itemprop="name" content="텐서보드를 이용한 파이토치 프로파일러">
        <meta itemprop="position" content="2">
      </div>
    </div>

    
    <script>
      if ((window.location.href.indexOf("/unstable/") != -1) && (window.location.href.indexOf("/unstable/unstable_index") < 1)) {
        var div = '<div class="prototype-banner"><i class="fa fa-flask" aria-hidden="true"></i> <strong>Unstable feature:</strong> Not typically available in binary distributions like PyPI. Early stage for feedback and testing.</div>'
        document.addEventListener('DOMContentLoaded', function () {
          document.getElementById("pytorch-article").insertAdjacentHTML('afterBegin', div);
        });
      }
    </script>
    
    
    <div class="pytorch-call-to-action-links">
      <div id="tutorial-type">intermediate/tensorboard_profiler_tutorial</div>
      <a id="colab-link" data-behavior="call-to-action-event" data-response="Run in Google Colab" target="_blank">
        <div id="google-colab-link">
          <img class="call-to-action-img" src="../_static/img/pytorch-colab.svg" />
          <div class="call-to-action-desktop-view">Run in Google Colab</div>
          <div class="call-to-action-mobile-view">Colab</div>
        </div>
      </a>
      <a id="notebook-link" data-behavior="call-to-action-event" data-response="Download Notebook">
        <div id="download-notebook-link">
          <img class="call-to-action-notebook-img" src="../_static/img/pytorch-download.svg" />
          <div class="call-to-action-desktop-view">Download Notebook</div>
          <div class="call-to-action-mobile-view">Notebook</div>
        </div>
      </a>
      <a id="github-link" data-behavior="call-to-action-event" data-response="View on Github" target="_blank">
        <div id="github-view-link">
          <img class="call-to-action-img" src="../_static/img/pytorch-github.svg" />
          <div class="call-to-action-desktop-view">View on GitHub</div>
          <div class="call-to-action-mobile-view">GitHub</div>
        </div>
      </a>
    </div>
    

    
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">참고</p>
<p><a class="reference internal" href="#sphx-glr-download-intermediate-tensorboard-profiler-tutorial-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="sphx-glr-intermediate-tensorboard-profiler-tutorial-py">
<span id="id1"></span><h1>텐서보드를 이용한 파이토치 프로파일러<a class="headerlink" href="#sphx-glr-intermediate-tensorboard-profiler-tutorial-py" title="Link to this heading">#</a></h1>
<p><strong>번역</strong>: <a class="reference external" href="https://github.com/dnd-qodqks">손동우</a></p>
<p>이 튜토리얼에서는 파이토치(PyTorch) 프로파일러(profiler)와 함께 텐서보드(TensorBoard) 플러그인(plugin)을 사용하여
모델의 성능 병목 현상을 탐지하는 방법을 보여 줍니다.</p>
<div class="admonition warning">
<p class="admonition-title">경고</p>
<p>TensorBoard와 PyTorch 프로파일러의 통합은 이제 더 이상 사용되지 않습니다.
대신 Perfetto 또는 Chrome 트레이스를 사용하여 <code class="docutils literal notranslate"><span class="pre">trace.json</span></code> 파일을 볼 수 있습니다.
<a class="reference external" href="https://tutorials.pytorch.kr/recipes/recipes/profiler_recipe.html#using-tracing-functionality">트레이스 생성</a> 후,
<code class="docutils literal notranslate"><span class="pre">trace.json</span></code> 파일을 <a class="reference external" href="https://ui.perfetto.dev/">Perfetto UI</a> 또는 <code class="docutils literal notranslate"><span class="pre">chrome://tracing</span></code> 에 드래그하여 프로파일을 시각화할 수 있습니다.</p>
</div>
<section id="id2">
<h2>소개<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>파이토치(PyTorch) 1.8부터 GPU에서 CUDA 커널(kernel) 실행 뿐만 아니라
CPU 작업을 기록할 수 있는 업데이트된 프로파일러 API가 포함되어 있습니다.
프로파일러는 텐서보드 플러그인에서 이런 정보를 시각화하고
성능 병목 현상에 대한 분석을 제공할 수 있습니다.</p>
<p>이 튜토리얼에서는 간단한 Resnet 모델을 사용하여
텐서보드 플러그인을 활용한 모델 성능 분석 방법을 보여드리겠습니다.</p>
</section>
<section id="id3">
<h2>준비<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>아래 명령어를 실행하여 <a href="#id4"><span class="problematic" id="id5">``</span></a>torch``와 <a href="#id6"><span class="problematic" id="id7">``</span></a>torchvision``을 설치합니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">torch</span> <span class="n">torchvision</span>
</pre></div>
</div>
</section>
<section id="id8">
<h2>과정<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>데이터 및 모델 준비</p></li>
<li><p>프로파일러를 사용하여 실행 이벤트(execution events) 기록</p></li>
<li><p>프로파일러 실행</p></li>
<li><p>텐서보드를 사용하여 결과 확인 및 모델 성능 분석</p></li>
<li><p>프로파일러의 도움으로 성능 개선</p></li>
<li><p>다른 고급 기능으로 성능 분석</p></li>
<li><p>추가 연습: AMD GPU에서 PyTorch 프로파일링</p></li>
</ol>
<section id="id9">
<h3>1. 데이터 및 모델 준비<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>먼저 필요한 라이브러리를 모두 불러옵니다:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.profiler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.utils.data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.datasets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.models</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.transforms</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">T</span>
</pre></div>
</div>
<p>이후 입력 데이터를 준비합니다. 이 튜토리얼의 경우 CIFAR10 데이터셋을 사용합니다.
원하는 형식으로 변환하고 <a href="#id10"><span class="problematic" id="id11">``</span></a>DataLoader``를 사용하여 각 배치(batch)를 로드합니다.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
     <span class="n">T</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
     <span class="n">T</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))])</span>
<span class="n">train_set</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0.00/170M [00:00&lt;?, ?B/s]
  0%|          | 32.8k/170M [00:00&lt;14:23, 197kB/s]
  0%|          | 65.5k/170M [00:00&lt;14:23, 197kB/s]
  0%|          | 98.3k/170M [00:00&lt;14:18, 199kB/s]
  0%|          | 229k/170M [00:00&lt;06:33, 432kB/s]
  0%|          | 459k/170M [00:00&lt;03:39, 775kB/s]
  1%|          | 918k/170M [00:00&lt;01:57, 1.45MB/s]
  1%|          | 1.84M/170M [00:01&lt;01:00, 2.78MB/s]
  2%|▏         | 3.70M/170M [00:01&lt;00:30, 5.47MB/s]
  4%|▍         | 7.14M/170M [00:01&lt;00:16, 9.93MB/s]
  6%|▌         | 10.0M/170M [00:01&lt;00:13, 12.1MB/s]
  8%|▊         | 13.1M/170M [00:01&lt;00:11, 13.8MB/s]
  9%|▉         | 16.0M/170M [00:02&lt;00:10, 14.9MB/s]
 11%|█         | 18.8M/170M [00:02&lt;00:09, 15.5MB/s]
 13%|█▎        | 21.8M/170M [00:02&lt;00:09, 16.1MB/s]
 14%|█▍        | 24.7M/170M [00:02&lt;00:08, 16.2MB/s]
 16%|█▋        | 27.8M/170M [00:02&lt;00:08, 16.7MB/s]
 18%|█▊        | 30.7M/170M [00:02&lt;00:08, 16.9MB/s]
 20%|█▉        | 33.7M/170M [00:03&lt;00:07, 17.1MB/s]
 22%|██▏       | 36.7M/170M [00:03&lt;00:07, 17.2MB/s]
 23%|██▎       | 39.6M/170M [00:03&lt;00:07, 17.2MB/s]
 25%|██▍       | 42.4M/170M [00:03&lt;00:07, 17.1MB/s]
 27%|██▋       | 45.3M/170M [00:03&lt;00:07, 16.5MB/s]
 28%|██▊       | 48.3M/170M [00:03&lt;00:07, 16.7MB/s]
 30%|███       | 51.2M/170M [00:04&lt;00:07, 16.8MB/s]
 32%|███▏      | 54.1M/170M [00:04&lt;00:06, 16.9MB/s]
 33%|███▎      | 57.0M/170M [00:04&lt;00:06, 17.0MB/s]
 35%|███▌      | 60.1M/170M [00:04&lt;00:06, 17.2MB/s]
 37%|███▋      | 63.0M/170M [00:04&lt;00:06, 17.1MB/s]
 39%|███▉      | 66.1M/170M [00:04&lt;00:06, 17.2MB/s]
 41%|████      | 69.2M/170M [00:05&lt;00:05, 17.3MB/s]
 42%|████▏     | 72.2M/170M [00:05&lt;00:05, 17.3MB/s]
 44%|████▍     | 75.2M/170M [00:05&lt;00:05, 17.3MB/s]
 46%|████▌     | 78.0M/170M [00:05&lt;00:05, 17.1MB/s]
 47%|████▋     | 81.0M/170M [00:05&lt;00:05, 17.2MB/s]
 49%|████▉     | 84.0M/170M [00:05&lt;00:05, 17.2MB/s]
 51%|█████     | 87.0M/170M [00:06&lt;00:04, 17.2MB/s]
 53%|█████▎    | 89.9M/170M [00:06&lt;00:04, 17.2MB/s]
 54%|█████▍    | 92.8M/170M [00:06&lt;00:04, 17.2MB/s]
 56%|█████▌    | 95.7M/170M [00:06&lt;00:04, 17.1MB/s]
 58%|█████▊    | 98.5M/170M [00:06&lt;00:04, 17.0MB/s]
 59%|█████▉    | 101M/170M [00:07&lt;00:04, 17.0MB/s]
 61%|██████    | 104M/170M [00:07&lt;00:03, 17.1MB/s]
 63%|██████▎   | 107M/170M [00:07&lt;00:03, 17.0MB/s]
 65%|██████▍   | 110M/170M [00:07&lt;00:03, 17.2MB/s]
 66%|██████▋   | 113M/170M [00:07&lt;00:03, 17.2MB/s]
 68%|██████▊   | 116M/170M [00:07&lt;00:03, 17.1MB/s]
 70%|██████▉   | 119M/170M [00:08&lt;00:02, 17.1MB/s]
 72%|███████▏  | 122M/170M [00:08&lt;00:02, 17.1MB/s]
 73%|███████▎  | 125M/170M [00:08&lt;00:02, 17.2MB/s]
 75%|███████▌  | 128M/170M [00:08&lt;00:02, 17.2MB/s]
 77%|███████▋  | 131M/170M [00:08&lt;00:02, 17.0MB/s]
 78%|███████▊  | 134M/170M [00:08&lt;00:02, 17.0MB/s]
 80%|████████  | 137M/170M [00:09&lt;00:01, 17.0MB/s]
 82%|████████▏ | 140M/170M [00:09&lt;00:01, 17.0MB/s]
 84%|████████▎ | 143M/170M [00:09&lt;00:01, 17.1MB/s]
 85%|████████▌ | 146M/170M [00:09&lt;00:01, 17.3MB/s]
 87%|████████▋ | 148M/170M [00:09&lt;00:01, 17.1MB/s]
 89%|████████▉ | 151M/170M [00:09&lt;00:01, 17.2MB/s]
 91%|█████████ | 154M/170M [00:10&lt;00:00, 17.2MB/s]
 92%|█████████▏| 157M/170M [00:10&lt;00:00, 17.1MB/s]
 94%|█████████▍| 160M/170M [00:10&lt;00:00, 17.0MB/s]
 96%|█████████▌| 163M/170M [00:10&lt;00:00, 16.9MB/s]
 97%|█████████▋| 166M/170M [00:10&lt;00:00, 16.9MB/s]
 99%|█████████▉| 169M/170M [00:10&lt;00:00, 17.0MB/s]
100%|██████████| 170M/170M [00:10&lt;00:00, 15.5MB/s]
</pre></div>
</div>
<p>그런 다음 Resnet 모델, 손실 함수 및 옵티마이저 객체를 생성합니다.
GPU에서 실행하기 위해 모델 및 손실을 GPU 장치로 이동합니다.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;IMAGENET1K_V1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
</pre></div>
</div>
<p>각 입력 데이터 배치에 대한 학습 단계를 정의합니다.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>2. 프로파일러를 사용하여 실행 이벤트 기록<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>프로파일러는 컨텍스트(context) 관리자를 통해 활성화되고 몇 가지 매개변수를 사용할 수 있으며,
가장 유용한 것은 아래와 같습니다:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">schedule</span></code> - step (int)을 단일 매개변수로 받아들이고,
각 단계에서 수행할 프로파일러 작업을 반환하는 호출 가능한 함수입니다.</p>
<p>이 예시에서는 <code class="docutils literal notranslate"><span class="pre">wait=1,</span> <span class="pre">warmup=1,</span> <span class="pre">active=3,</span> <span class="pre">repeat=1</span></code> 로 설정되어 있으며,
프로파일러는 첫 번째 단계/반복(step/iteration)을 건너뜁니다.
두 번째부터 워밍업(warming up)을 시작하면,
다음 세 번의 반복을 기록하고,
그 후 추적(trace)을 사용할 수 있게 되고 on_trace_ready (설정된 경우)가 호출됩니다.
전체적으로 이 주기가 한 번 반복됩니다. 텐서보드 플러그인에서 각 주기는 “span”이라고 합니다.</p>
<p><code class="docutils literal notranslate"><span class="pre">wait</span></code> 단계인 동안 프로파일러는 비활성화됩니다.
<code class="docutils literal notranslate"><span class="pre">warmup</span></code> 단계인 동안엔 프로파일러가 추적(tracing)을 시작하지만 결과는 무시됩니다.
이는 프로파일링 과부하(overhead)를 줄이기 위함입니다.
프로파일링을 시작할 때 과부하는 크고 프로파일링 결과에 왜곡을 가져오기 쉽습니다.
<code class="docutils literal notranslate"><span class="pre">active</span></code> 단계에선 프로파일러가 작동하며 이벤트를 기록합니다.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_trace_ready</span></code> - 각 주기 마지막에 호출되는 함수입니다;
이 예시에서는 <code class="docutils literal notranslate"><span class="pre">torch.profiler.tensorboard_trace_handler``를</span> <span class="pre">사용하여</span> <span class="pre">텐서보드의</span> <span class="pre">결과</span> <span class="pre">파일을</span> <span class="pre">생성합니다.</span>
<span class="pre">프로파일링</span> <span class="pre">후</span> <span class="pre">결과</span> <span class="pre">파일은</span> <span class="pre">``./log/resnet18</span></code> 디렉토리에 저장됩니다.
텐서보드에서 프로파일(profile)을 분석하려면 이 디렉토리를 <code class="docutils literal notranslate"><span class="pre">logdir</span></code> 매개변수로 지정해야 합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">record_shapes</span></code> - 연산자 입력의 shape을 기록할지 여부를 나타냅니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">profile_memory</span></code> - Track tensor memory 할당/할당 해제 여부를 나타냅니다. 주의, 1.10 이전 버전의 파이토치를 사용하는 경우
프로파일링 시간이 길다면 이 기능을 비활성화하거나 새 버전으로 업그레이드해 주세요.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">with_stack</span></code> - ops에 대한 소스 정보(파일 및 라인 번호)를 기록 여부를 나타냅니다.
만약 VS Code에서 텐서보드를 실행하는 경우 (<a class="reference external" href="https://code.visualstudio.com/docs/datascience/pytorch-support#_tensorboard-integration">참고</a>),
스택 프레임(stack frame)을 클릭하면 특정 코드 라인으로 이동합니다.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span>
        <span class="n">schedule</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">warmup</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">on_trace_ready</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">tensorboard_trace_handler</span><span class="p">(</span><span class="s1">&#39;./log/resnet18&#39;</span><span class="p">),</span>
        <span class="n">record_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">profile_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_stack</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">prof</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">batch_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
        <span class="n">prof</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>  <span class="c1"># 각 단계에서 호출하여 프로파일러에게 단계의 경계를 알려야 합니다.</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">train</span><span class="p">(</span><span class="n">batch_data</span><span class="p">)</span>
</pre></div>
</div>
<p>또한, 다음의 non-context 관리자(manager)는 시작(start)/정지(stop) 기능도 지원됩니다.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span>
        <span class="n">schedule</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">warmup</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">on_trace_ready</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">profiler</span><span class="o">.</span><span class="n">tensorboard_trace_handler</span><span class="p">(</span><span class="s1">&#39;./log/resnet18&#39;</span><span class="p">),</span>
        <span class="n">record_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prof</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">batch_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">train</span><span class="p">(</span><span class="n">batch_data</span><span class="p">)</span>
<span class="n">prof</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>3. 프로파일러 실행<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>위 코드를 실행합니다. 프로파일링 결과는 <code class="docutils literal notranslate"><span class="pre">./log/resnet18</span></code> 디렉토리에 저장됩니다.</p>
</section>
<section id="id14">
<h3>4. 텐서보드를 사용하여 결과 확인 및 모델 성능 분석<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">참고</p>
<p>텐서보드 플러그인(Tensorboard Plugin) 지원이 중단되었으므로, 아래 기능들 중 일부는
이전처럼 동작하지 않을 수 있습니다. 이에 대한 대안으로 <a class="reference external" href="https://github.com/pytorch/kineto/tree/main#holistic-trace-analysis">HTA</a>
를 사용할 수 있습니다.</p>
</div>
<p>파이토치 프로파일러 텐서보드 플러그인을 설치합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">torch_tb_profiler</span>
</pre></div>
</div>
<p>텐서보드를 실행합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensorboard</span> <span class="o">--</span><span class="n">logdir</span><span class="o">=./</span><span class="n">log</span>
</pre></div>
</div>
<p>구글 크롬(Google Chrome) 브라우저 또는 마이크로소프트 엣지(Microsoft Edge) 브라우저에서 텐서보드 프로파일(profile) URL에 접속합니다. (<strong>Safari 브라우저는 지원하지 않습니다.</strong>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">6006</span><span class="o">/</span><span class="c1">#pytorch_profiler</span>
</pre></div>
</div>
<p>아래와 같이 프로파일러 플러그인 페이지를 볼 수 있습니다.</p>
<ul class="simple">
<li><p>개요(Overview)</p></li>
</ul>
<a class="reference internal image-reference" href="../_static/img/profiler_overview1.png"><img alt="../_static/img/profiler_overview1.png" src="../_static/img/profiler_overview1.png" /></a>
<p>개요 페이지에는 모델 성능에 대한 대략적인 요약이 표시됩니다.</p>
<p>“GPU 요약(GPU Summary)” 패널에는 GPU 구성, GPU 사용량 및 Tensor 코어 사용량이 표시됩니다.
이 예제에서는 GPU 사용량이 낮습니다.
이러한 측정 지표(metrics)에 대한 자세한 내용은 <a class="reference external" href="https://github.com/pytorch/kineto/blob/main/tb_plugin/docs/gpu_utilization.md">여기</a> 에서 확인해주세요.</p>
<p>“단계 시간 세분화(Step Time Breakdown)”는 각 단계에서 수행된 시간의 분포를 보여줍니다.
이 예제에서는 <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> 과부하가 상당한 것을 볼 수 있습니다.</p>
<p>하단의 “성능 권장사항(Performance Recommendation)”은 프로파일링 데이터를 사용하여
발생 가능한 병목 현상을 자동으로 강조하고,
실행 가능한 최적화 제안을 제공합니다.</p>
<p>왼쪽 “보기(Views)” 드롭다운(dropdown) 목록에서 보기 페이지를 변경할 수 있습니다.</p>
<img alt="" src="../_static/img/profiler_views_list.png" />
<ul class="simple">
<li><p>연산 보기(Operator view)</p></li>
</ul>
<p>연산 보기는 호스트 또는 장치에서 실행되는
모든 파이토치 연산자의 성능을 표시합니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_operator_view.png"><img alt="../_static/img/profiler_operator_view.png" src="../_static/img/profiler_operator_view.png" /></a>
<p>“셀프(Self)” 기간에는 하위 연산의 시간이 포함되지 않습니다.
“전체(Total)” 기간에는 하위 연산의 시간이 포함됩니다.</p>
<ul class="simple">
<li><p>호출 스택 보기(View call stack)</p></li>
</ul>
<p>연산자의 <a href="#id15"><span class="problematic" id="id16">``</span></a>View Callstack``를 클릭하면, 이름은 같지만 서로 다른 연산자가 표시됩니다.
하위 테이블의 <a href="#id17"><span class="problematic" id="id18">``</span></a>View Callstack``를 클릭하면, 호출 스택 프레임(call stack frames)이 표시됩니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_callstack.png"><img alt="../_static/img/profiler_callstack.png" src="../_static/img/profiler_callstack.png" /></a>
<p>VS Code 내부에서 텐서보드가 실행되는 경우
(<a class="reference external" href="https://devblogs.microsoft.com/python/python-in-visual-studio-code-february-2021-release/#tensorboard-integration">실행 가이드</a>),
호출 스택 프레임(call stack frame)을 클릭하면 특정 코드 라인으로 이동합니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_vscode.png"><img alt="../_static/img/profiler_vscode.png" src="../_static/img/profiler_vscode.png" /></a>
<ul class="simple">
<li><p>커널 보기(Kernel view)</p></li>
</ul>
<p>GPU 커널 보기(GPU kernel view)는 모든 커널(kernel)이 GPU에 소비한 시간을 보여줍니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_kernel_view.png"><img alt="../_static/img/profiler_kernel_view.png" src="../_static/img/profiler_kernel_view.png" /></a>
<p>사용된 Tensor 코어:
이 커널(kernel)이 tensor 코어를 사용하는지 여부룰 나타냅니다.</p>
<p>SM당 평균 블럭 수:
SM당 블럭 수 = 커널(kernel)의 블럭 / GPU의 SM 수.
이 수치가 1보다 작으면 GPU 멀티프로세서가 완전히 사용되지 않음을 나타냅니다.
“SM당 평균 블럭 수(Mean Blocks per SM)”는 이 커널 이름의 모든 실행에 대한 가중 평균이고, 각 실행 기간을 가중치로 사용하였습니다.</p>
<p>평균 예상 달성 점유율(Mean Est. Achieved Occupancy):
예상 달성 점유율(Est. Achieved Occupancy)은 열의 툴팁(column’s tooltip)에 정의되어 있습니다.
메모리 대역폭 경계 커널과 같은 대부분의 경우, 높을수록 좋습니다.
“평균 예상 달성 점유율(Mean Est. Achieved Occupancy)”은 커널 이름의 모든 실행에 대한 가중 평균이며,
각 실행의 지속 시간을 가중치로 사용합니다.</p>
<ul class="simple">
<li><p>추적 보기(Trace view)</p></li>
</ul>
<p>추적 보기는 프로파일된 연산자와 GPU 커널의 타임라인을 보여줍니다.
아래와 같이 선택하여 세부 정보를 확인할 수 있습니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_trace_view1.png"><img alt="../_static/img/profiler_trace_view1.png" src="../_static/img/profiler_trace_view1.png" /></a>
<p>오른쪽 도구 모음을 사용하여 그래프를 이동하고 확대/축소할 수 있습니다.
또한 키보드를 사용하여 타임라인 안에서 확대/이동할 수 있습니다.
‘w’및 ‘s’ 키는 마우스 중심으로 확대되며,
‘a’와 ‘d’ 키는 타임라인을 좌우로 이동합니다.
읽을 수 있는 표현이 보일 때까지 이 키를 여러 번 누를 수 있습니다.</p>
<p>역방향 연산자(backward operator)의 “Incoming Flow” 필드가 “forward correspond to backward” 값인 경우,
텍스트를 클릭하여 시작되는 전진 연산자(forward operator)를 가져올 수 있습니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_trace_view_fwd_bwd.png"><img alt="../_static/img/profiler_trace_view_fwd_bwd.png" src="../_static/img/profiler_trace_view_fwd_bwd.png" /></a>
<p>이 예시에서는 <a href="#id19"><span class="problematic" id="id20">``</span></a>enumerate(DataLoader)``로 접두사가 붙은 이벤트에 많은 시간이 소요되는 것을 확인할 수 있습니다.
그리고 대부분의 기간 동안 GPU는 쉬는 상태입니다.
이 기능은 호스트 측에서 데이터를 로드하고 데이터를 변환하는 기능이기 때문에,
GPU 리소스가 낭비됩니다.</p>
</section>
<section id="id21">
<h3>5. 프로파일러의 도움으로 성능 개선<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<p>“개요(Overview)” 페이지 하단의 “성능 추천(Performance Recommendation)” 제안은 병목 현상이 “ <a href="#id22"><span class="problematic" id="id23">``</span></a>DataLoader``임을 암시합니다.
파이토치 <a href="#id24"><span class="problematic" id="id25">``</span></a>DataLoader``는 기본적으로 단일 프로세스를 사용합니다.
사용자는 매개변수 <a href="#id26"><span class="problematic" id="id27">``</span></a>num_workers``를 설정하여 다중 프로세스 데이터 로드를 활성화할 수 있습니다.
자세한 내용은 <a class="reference external" href="https://pytorch.org/docs/stable/data.html#single-and-multi-process-data-loading">여기</a> 에 있습니다.</p>
<p>이 예시에서 “성능 권장사항(Performance Recommendation)”에 따라 아래와 같이 <a href="#id28"><span class="problematic" id="id29">``</span></a>num_workers``를 설정하고,
<a href="#id30"><span class="problematic" id="id31">``</span></a>./log/resnet18_4workers``와 같은 다른 이름을 <a href="#id32"><span class="problematic" id="id33">``</span></a>tensorboard_trace_handler``로 전달한 후 다시 실행합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>그런 다음 왼쪽 “실행(Runs)” 드롭다운(dropdown) 목록에서 최근 프로파일된 실행을 선택합니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_overview2.png"><img alt="../_static/img/profiler_overview2.png" src="../_static/img/profiler_overview2.png" /></a>
<p>위의 보기(view)에서 이전 실행인 132ms에 비해 단계(step) 시간이 약 76ms로 감소하고,
<a href="#id34"><span class="problematic" id="id35">``</span></a>DataLoader``의 시간 감소가 주로 기여한다는 것을 알 수 있습니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_trace_view2.png"><img alt="../_static/img/profiler_trace_view2.png" src="../_static/img/profiler_trace_view2.png" /></a>
<p>위의 보기(view)에서 <a href="#id36"><span class="problematic" id="id37">``</span></a>enumerate(DataLoader)``의 런타임이 감소하고,
GPU 활용도가 증가하는 것을 알 수 있습니다.</p>
</section>
<section id="id38">
<h3>6. 다른 고급 기능으로 성능 분석<a class="headerlink" href="#id38" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>메모리 보기(Memory view)</p></li>
</ul>
<p>메모리 프로파일을 설정하려면 <code class="docutils literal notranslate"><span class="pre">torch.profiler.profile</span></code> 인수에서 <a href="#id39"><span class="problematic" id="id40">``</span></a>profile_memory``를 <a href="#id41"><span class="problematic" id="id42">``</span></a>True``로 설정해야 합니다.</p>
<p>Azure의 기존 예제를 사용해 볼 수 있습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">azure</span><span class="o">-</span><span class="n">storage</span><span class="o">-</span><span class="n">blob</span>
<span class="n">tensorboard</span> <span class="o">--</span><span class="n">logdir</span><span class="o">=</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">torchtbprofiler</span><span class="o">.</span><span class="n">blob</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">torchtbprofiler</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">memory_demo_1_10</span>
</pre></div>
</div>
<p>프로파일러는 프로파일링 중에 모든 메모리 할당/해제 이벤트와 할당자의 내부 상태를 기록합니다.
메모리 보기(memory view)는 다음과 같이 세 가지 요소로 구성됩니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_memory_view.png"><img alt="../_static/img/profiler_memory_view.png" src="../_static/img/profiler_memory_view.png" /></a>
<p>구성 요소는 각각 메모리 곡선 그래프, 메모리 이벤트 테이블 및 메모리 통계 테이블입니다.</p>
<p>메모리 유형은 “장치(Device)” 선택 상자에서 선택할 수 있습니다.
예를 들면, 다음 표에서 “GPU0”은 GPU 0에서의 각 연산자의 메로리 사용량만 보여주고, CPU 또는 다른 GPU를 포함하지 않는다는 것을 의미합니다.</p>
<p>메모리 곡선은 메모리 소비의 추세를 보여줍니다. “Allocated” 곡선은 실제 사용 중인 총 메모리,
예를 들면 tensor를 보여줍니다. 파이토치에서 캐싱 메커니즘(caching mechanism)은 CUDA 할당기 및 일부 다른 할당기에 사용됩니다.
“Reserved” 곡선은 할당자에 의해 예약된 총 메모리를 보여줍니다. 그래프를 좌클릭하고 끌어서
원하는 범위의 이벤트를 선택할 수 있습니다:</p>
<a class="reference internal image-reference" href="../_static/img/profiler_memory_curve_selecting.png"><img alt="../_static/img/profiler_memory_curve_selecting.png" src="../_static/img/profiler_memory_curve_selecting.png" /></a>
<p>선택한 후에는 세 가지 구성 요소가 제한된 범위에 맞게 업데이트되어
자세한 정보를 얻을 수 있습니다. 이 프로세스를 반복하면, 매우 세분화된 세부 정보를 확대할 수 있습니다. 그래프를 우클릭하면
그래프가 초기 상태로 재설정됩니다.</p>
<a class="reference internal image-reference" href="../_static/img/profiler_memory_curve_single.png"><img alt="../_static/img/profiler_memory_curve_single.png" src="../_static/img/profiler_memory_curve_single.png" /></a>
<p>메모리 이벤트 테이블에서 할당 및 해제 이벤트는 하나의 항목으로 쌍으로 구성됩니다. “operator” 열에는
할당을 발생시키는 즉시 ATen 연산자가 표시됩니다. 파이토치에서 ATen 연산자는 일반적으로
<code class="docutils literal notranslate"><span class="pre">aten::empty``를</span> <span class="pre">사용하여</span> <span class="pre">메모리를</span> <span class="pre">할당합니다.</span> <span class="pre">예를</span> <span class="pre">들어,</span> <span class="pre">``aten::ones``은</span> <span class="pre">``aten::empty</span></code> 다음에
<a href="#id43"><span class="problematic" id="id44">``</span></a>aten::fill_``로 구현됩니다. 연산자 이름만 <a href="#id45"><span class="problematic" id="id46">``</span></a>aten::empty``로 표시해도 별 도움이 되지 않습니다. 이 특수한 경우에는
<a href="#id47"><span class="problematic" id="id48">``</span></a>aten::ones (aten::empty)``로 표시됩니다. “할당 시간(Allocation Time)”, “해제 시간(Release Time)” 및 “기간(Duration)”은
이벤트가 시간 범위를 벗어나는 경우 열의 데이터가 누락될 수 있습니다.</p>
<p>메모리 통계 테이블에서, “크기 증가(Size Increase)” 열은 모든 할당 크기를 합산하고 모든 메모리 릴리스(release)
크기를 뺀 값, 즉, 이 연산자 이후의 메모리 사용량 순 증가 값입니다. “자체 크기 증가(Self Size Increase)” 열은
“크기 증가(Size Increase)”와 유사 하지만, 하위 연산자의 할당은 계산하지 않습니다. ATen 연산자의 구현 세부 사항과
관련하여, 일부 연산자는 다른 연산자를 호출할 수 있으므로, 메모리 할당은 콜 스택의 모든 수준에서
발생할 수 있습니다. 즉, “자체 크기 증가(Self Size Increase)”는 현재 수준의 콜 스택에서 메모리 사용량 증가만을 계산합니다.
마지막으로, “할당 크기(Allocation Size)” 열은 메모리 릴리스를 고려하지 않고 모든 할당을 합산합니다.</p>
<ul class="simple">
<li><p>분산 보기(Distributed view)</p></li>
</ul>
<p>이제 플러그인은 NCCL/GLOO를 백엔드로 사용하는 DDP 프로파일링에 대한 분산 보기를 지원합니다.</p>
<p>Azure의 기존 예제를 사용해 볼 수 있습니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">azure</span><span class="o">-</span><span class="n">storage</span><span class="o">-</span><span class="n">blob</span>
<span class="n">tensorboard</span> <span class="o">--</span><span class="n">logdir</span><span class="o">=</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">torchtbprofiler</span><span class="o">.</span><span class="n">blob</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">torchtbprofiler</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">distributed_bert</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_static/img/profiler_distributed_view.png"><img alt="../_static/img/profiler_distributed_view.png" src="../_static/img/profiler_distributed_view.png" /></a>
<p>“컴퓨팅/커뮤니케이션 개요(Computation/Communication Overview)”에는 컴퓨팅/커뮤니케이션 비율과 중복 정도가 표시됩니다.
이 보기에서, 사용자는 작업자 간의 로드 밸런싱 문제를 파악할 수 있습니다.
예를 들어, 한 작업자의 연산 + 중복 시간이 다른 작업자보다 훨씬 큰 경우,
로드 밸런싱에 문제가 있거나 이 작업자가 낙오자(straggler)일 수 있습니다.</p>
<p>“동기화/커뮤니케이션 개요(Synchronizing/Communication Overview)”는 통신의 효율성을 보여줍니다.
“데이터 교환 시간(Data Transfer Time)”은 실제 데이터를 교환하는 시간입니다.
“동기화 시간(Synchronizing Time)”은 다른 작업자와 대기 및 동기화하는 시간입니다.</p>
<p>한 작업자의 “동기화 시간”이 다른 작업자 보다 훨씬 짧다면’,
이 작업자는 다른 작업자보다 더 많은 계산 작업량을 가질 수 있는 낙오자(straggler)일 수 있습니다’.</p>
<p>“커뮤니케이션 작업 통계(Communication Operations Stats)”는 각 작업자의 모든 통신 작업에 대한 세부 통계를 요약합니다.</p>
</section>
<section id="amd-gpu-pytorch">
<h3>7. 추가 연습: AMD GPU에서 PyTorch 프로파일링<a class="headerlink" href="#amd-gpu-pytorch" title="Link to this heading">#</a></h3>
<p>The AMD ROCm Platform is an open-source software stack designed for GPU computation, consisting of drivers, development tools, and APIs.
We can run the above mentioned steps on AMD GPUs. In this section, we will use Docker to install the ROCm base development image
before installing PyTorch.</p>
<p>For the purpose of example, let’s create a directory called <code class="docutils literal notranslate"><span class="pre">profiler_tutorial</span></code>, and save the code in <strong>Step 1</strong> as <code class="docutils literal notranslate"><span class="pre">test_cifar10.py</span></code> in this directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">~/</span><span class="n">profiler_tutorial</span>
<span class="n">cd</span> <span class="n">profiler_tutorial</span>
<span class="n">vi</span> <span class="n">test_cifar10</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>At the time of this writing, the Stable(<code class="docutils literal notranslate"><span class="pre">2.1.1</span></code>) Linux version of PyTorch on ROCm Platform is <a class="reference external" href="https://pytorch.org/get-started/locally/">ROCm 5.6</a>.</p>
<ul class="simple">
<li><p>Obtain a base Docker image with the correct user-space ROCm version installed from <a class="reference external" href="https://hub.docker.com/repository/docker/rocm/dev-ubuntu-20.04">Docker Hub</a>.</p></li>
</ul>
<p>It is <code class="docutils literal notranslate"><span class="pre">rocm/dev-ubuntu-20.04:5.6</span></code>.</p>
<ul class="simple">
<li><p>Start the ROCm base Docker container:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">network</span><span class="o">=</span><span class="n">host</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">kfd</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dri</span> <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">add</span><span class="o">=</span><span class="n">video</span> <span class="o">--</span><span class="n">ipc</span><span class="o">=</span><span class="n">host</span> <span class="o">--</span><span class="n">cap</span><span class="o">-</span><span class="n">add</span><span class="o">=</span><span class="n">SYS_PTRACE</span> <span class="o">--</span><span class="n">security</span><span class="o">-</span><span class="n">opt</span> <span class="n">seccomp</span><span class="o">=</span><span class="n">unconfined</span> <span class="o">--</span><span class="n">shm</span><span class="o">-</span><span class="n">size</span> <span class="mi">8</span><span class="n">G</span> <span class="o">-</span><span class="n">v</span> <span class="o">~/</span><span class="n">profiler_tutorial</span><span class="p">:</span><span class="o">/</span><span class="n">profiler_tutorial</span> <span class="n">rocm</span><span class="o">/</span><span class="n">dev</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">20.04</span><span class="p">:</span><span class="mf">5.6</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Inside the container, install any dependencies needed for installing the wheels package.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libjpeg</span><span class="o">-</span><span class="n">dev</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="o">-</span><span class="n">y</span>
<span class="n">pip3</span> <span class="n">install</span> <span class="n">wheel</span> <span class="n">setuptools</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="ow">is</span><span class="o">-</span><span class="n">python3</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Install the wheels:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">torch</span> <span class="n">torchvision</span> <span class="n">torchaudio</span> <span class="o">--</span><span class="n">index</span><span class="o">-</span><span class="n">url</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">pytorch</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">whl</span><span class="o">/</span><span class="n">rocm5</span><span class="mf">.6</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Install the <code class="docutils literal notranslate"><span class="pre">torch_tb_profiler</span></code>, and then, run the Python file <code class="docutils literal notranslate"><span class="pre">test_cifar10.py</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">torch_tb_profiler</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">profiler_tutorial</span>
<span class="n">python</span> <span class="n">test_cifar10</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Now, we have all the data needed to view in TensorBoard:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensorboard</span> <span class="o">--</span><span class="n">logdir</span><span class="o">=./</span><span class="n">log</span>
</pre></div>
</div>
<p>Choose different views as described in <strong>Step 4</strong>. For example, below is the <strong>Operator</strong> View:</p>
<a class="reference internal image-reference" href="../_static/img/profiler_rocm_tensorboard_operartor_view.png"><img alt="../_static/img/profiler_rocm_tensorboard_operartor_view.png" src="../_static/img/profiler_rocm_tensorboard_operartor_view.png" /></a>
<p>At the time this section is written, <strong>Trace</strong> view does not work and it displays nothing. You can work around by typing <code class="docutils literal notranslate"><span class="pre">chrome://tracing</span></code> in your Chrome Browser.</p>
<ul class="simple">
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">trace.json</span></code> file under <code class="docutils literal notranslate"><span class="pre">~/profiler_tutorial/log/resnet18</span></code> directory to the Windows.</p></li>
</ul>
<p>You may need to copy the file by using <code class="docutils literal notranslate"><span class="pre">scp</span></code> if the file is located in a remote location.</p>
<ul class="simple">
<li><p>Click <strong>Load</strong> button to load the trace JSON file from the <code class="docutils literal notranslate"><span class="pre">chrome://tracing</span></code> page in the browser.</p></li>
</ul>
<a class="reference internal image-reference" href="../_static/img/profiler_rocm_chrome_trace_view.png"><img alt="../_static/img/profiler_rocm_chrome_trace_view.png" src="../_static/img/profiler_rocm_chrome_trace_view.png" /></a>
<p>As mentioned previously, you can move the graph and zoom in and out.
You can also use keyboard to zoom and move around inside the timeline.
The <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> keys zoom in centered around the mouse,
and the <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">d</span></code> keys move the timeline left and right.
You can hit these keys multiple times until you see a readable representation.</p>
</section>
</section>
<section id="id49">
<h2>더 알아보기<a class="headerlink" href="#id49" title="Link to this heading">#</a></h2>
<p>학습을 계속하려면 다음 문서를 참조하시고,
<a class="reference external" href="https://github.com/pytorch/kineto/issues">여기</a> 에서 자유롭게 이슈를 열어보세요.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytorch/kineto/tree/master/tb_plugin">PyTorch TensorBoard Profiler Github</a></p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/master/profiler.html">torch.profiler API</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytorch/kineto/tree/main#holistic-trace-analysis">HTA</a></p></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 19.780 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-intermediate-tensorboard-profiler-tutorial-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0aec568a42e89122e5ca293c86289287/tensorboard_profiler_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tensorboard_profiler_tutorial.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/67e47b6d6793c700666471b688068f72/tensorboard_profiler_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tensorboard_profiler_tutorial.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/180ec9b33649e3199154d56f44f40877/tensorboard_profiler_tutorial.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">tensorboard_profiler_tutorial.zip</span></code></a></p>
</div>
</div>
</section>
</section>


                </article>
              
  </article>
  
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item">
<div class="feedback">
  
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>

  <div class="feedback-send">
    <button class="feedback-btn"
            onclick="openGitHubIssue()"
            data-bs-title="Create a GitHub Issue"
            data-bs-placement="bottom"
            data-bs-toggle="tooltip"
            data-gtm="feedback-btn-click">Send Feedback
    </button>
  </div>
</div>

<div class="prev-next-area">
    <a class="left-prev"
       href="ax_multiobjective_nas_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">이전</p>
        <p class="prev-next-title">Multi-Objective NAS with Ax</p>
      </div>
    </a>
    <a class="right-next"
       href="realtime_rpi.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">다음</p>
        <p class="prev-next-title">Raspberry Pi 4 에서 실시간 추론(Inference) (30fps!)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>

<div class="footer-info">
  <p class="copyright">
    
      
        © Copyright 2018-2025, PyTorch &amp; 파이토치 한국 사용자 모임(PyTorchKR).
      
      <br/>
    
  </p>

  <p class="theme-version">
    Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
  </p>
</div>
</div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ax_multiobjective_nas_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">이전</p>
        <p class="prev-next-title">Multi-Objective NAS with Ax</p>
      </div>
    </a>
    <a class="right-next"
       href="realtime_rpi.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">다음</p>
        <p class="prev-next-title">Raspberry Pi 4 에서 실시간 추론(Inference) (30fps!)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc">
<div class="sidebar-secondary-items sidebar-secondary__inner">
    
       <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">소개</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">준비</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">과정</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">1. 데이터 및 모델 준비</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">2. 프로파일러를 사용하여 실행 이벤트 기록</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">3. 프로파일러 실행</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">4. 텐서보드를 사용하여 결과 확인 및 모델 성능 분석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">5. 프로파일러의 도움으로 성능 개선</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">6. 다른 고급 기능으로 성능 분석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-gpu-pytorch">7. 추가 연습: AMD GPU에서 PyTorch 프로파일링</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">더 알아보기</a></li>
</ul>
  </nav></div>
    




<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Libraries</div>
  <ul style="list-style-type: none; padding: 0; padding-bottom: 80px;">
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/ao" style="color: var(--pst-color-text-muted)">torchao</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/torchrec" style="color: var(--pst-color-text-muted)">torchrec</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/torchft" style="color: var(--pst-color-text-muted)">torchft</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/torchcodec" style="color: var(--pst-color-text-muted)">TorchCodec</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/vision" style="color: var(--pst-color-text-muted)">torchvision</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/executorch" style="color: var(--pst-color-text-muted)">ExecuTorch</a></li>
  
   <li><a class="nav-link nav-external" href="https://docs.pytorch.org/xla" style="color: var(--pst-color-text-muted)">PyTorch on XLA Devices</a></li>
  
  </ul>
</div>

</div>
</div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <div class="container-fluid docs-tutorials-resources">
  <div class="container">
    <div class="row">
      <div class="col-md-4 text-center">
        <h2>PyTorchKorea @ GitHub</h2>
        <p>파이토치 한국 사용자 모임을 GitHub에서 만나보세요.</p>
        <a class="with-right-arrow" href="https://github.com/PyTorchKorea">GitHub로 이동</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>한국어 튜토리얼</h2>
        <p>한국어로 번역 중인 파이토치 튜토리얼을 만나보세요.</p>
        <a class="with-right-arrow" href="https://tutorials.pytorch.kr/">튜토리얼로 이동</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>한국어 커뮤니티</h2>
        <p>다른 사용자들과 의견을 나누고, 도와주세요!</p>
        <a class="with-right-arrow" href="https://discuss.pytorch.kr/">커뮤니티로 이동</a>
      </div>
    </div>
  </div>
</div>

<footer class="site-footer">
  <div class="container footer-container">
    <div class="footer-logo-wrapper">
      <a href="https://pytorch.kr/" class="footer-logo"></a>
    </div>

    <div class="footer-links-wrapper">
      <div class="footer-links-col">
        <ul>
          <li class="list-title"><a href="https://pytorch.kr/">파이토치 한국 사용자 모임</a></li>
          <li><a href="https://pytorch.kr/about">사용자 모임 소개</a></li>
          <li><a href="https://pytorch.kr/contributors">기여해주신 분들</a></li>
          <li><a href="https://pytorch.kr/resources/">리소스</a></li>
          <li><a href="https://pytorch.kr/coc">행동 강령</a></li>
        </ul>
      </div>
    </div>

    <div class="trademark-disclaimer">
      <ul>
        <li>이 사이트는 독립적인 파이토치 사용자 커뮤니티로, 최신 버전이 아니거나 잘못된 내용이 포함되어 있을 수 있습니다. This site is an independent user community and may be out of date or contain incorrect information.</li>
        <li><a href="https://pytorch.kr/coc">행동 강령</a>을 읽고 지켜주세요. PyTorch 공식 로고 사용 규정은 <a href="https://www.linuxfoundation.org/policies/">Linux Foundation의 정책</a>을 따릅니다. Please read and follow <a href="https://pytorch.kr/coc">our code of conduct</a>. All PyTorch trademark policy applicable to <a href="https://www.linuxfoundation.org/policies/">Linux Foundation's policies</a>.</li>
      </ul>
    </div>
  </div>
</footer>

<div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/img/pytorch-x.svg">
  </div>
</div>
  
  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2025, PyTorch &amp; 파이토치 한국 사용자 모임(PyTorchKR).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6 버전으로 생성되었습니다.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  <script type="application/ld+json">
    {
       "@context": "https://schema.org",
       "@type": "Article",
       "name": "\ud150\uc11c\ubcf4\ub4dc\ub97c \uc774\uc6a9\ud55c \ud30c\uc774\ud1a0\uce58 \ud504\ub85c\ud30c\uc77c\ub7ec",
       "headline": "\ud150\uc11c\ubcf4\ub4dc\ub97c \uc774\uc6a9\ud55c \ud30c\uc774\ud1a0\uce58 \ud504\ub85c\ud30c\uc77c\ub7ec",
       "description": "PyTorch Documentation. Explore PyTorch, an open-source machine learning library that accelerates the path from research prototyping to production deployment. Discover tutorials, API references, and guides to help you build and deploy deep learning models efficiently.",
       "url": "/intermediate/tensorboard_profiler_tutorial.html",
       "articleBody": "\ucc38\uace0 Go to the end to download the full example code. \ud150\uc11c\ubcf4\ub4dc\ub97c \uc774\uc6a9\ud55c \ud30c\uc774\ud1a0\uce58 \ud504\ub85c\ud30c\uc77c\ub7ec# \ubc88\uc5ed: \uc190\ub3d9\uc6b0 \uc774 \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c\ub294 \ud30c\uc774\ud1a0\uce58(PyTorch) \ud504\ub85c\ud30c\uc77c\ub7ec(profiler)\uc640 \ud568\uaed8 \ud150\uc11c\ubcf4\ub4dc(TensorBoard) \ud50c\ub7ec\uadf8\uc778(plugin)\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubaa8\ub378\uc758 \uc131\ub2a5 \ubcd1\ubaa9 \ud604\uc0c1\uc744 \ud0d0\uc9c0\ud558\ub294 \ubc29\ubc95\uc744 \ubcf4\uc5ec \uc90d\ub2c8\ub2e4. \uacbd\uace0 TensorBoard\uc640 PyTorch \ud504\ub85c\ud30c\uc77c\ub7ec\uc758 \ud1b5\ud569\uc740 \uc774\uc81c \ub354 \uc774\uc0c1 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub300\uc2e0 Perfetto \ub610\ub294 Chrome \ud2b8\ub808\uc774\uc2a4\ub97c \uc0ac\uc6a9\ud558\uc5ec trace.json \ud30c\uc77c\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud2b8\ub808\uc774\uc2a4 \uc0dd\uc131 \ud6c4, trace.json \ud30c\uc77c\uc744 Perfetto UI \ub610\ub294 chrome://tracing \uc5d0 \ub4dc\ub798\uadf8\ud558\uc5ec \ud504\ub85c\ud30c\uc77c\uc744 \uc2dc\uac01\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc18c\uac1c# \ud30c\uc774\ud1a0\uce58(PyTorch) 1.8\ubd80\ud130 GPU\uc5d0\uc11c CUDA \ucee4\ub110(kernel) \uc2e4\ud589 \ubfd0\ub9cc \uc544\ub2c8\ub77c CPU \uc791\uc5c5\uc744 \uae30\ub85d\ud560 \uc218 \uc788\ub294 \uc5c5\ub370\uc774\ud2b8\ub41c \ud504\ub85c\ud30c\uc77c\ub7ec API\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \ud504\ub85c\ud30c\uc77c\ub7ec\ub294 \ud150\uc11c\ubcf4\ub4dc \ud50c\ub7ec\uadf8\uc778\uc5d0\uc11c \uc774\ub7f0 \uc815\ubcf4\ub97c \uc2dc\uac01\ud654\ud558\uace0 \uc131\ub2a5 \ubcd1\ubaa9 \ud604\uc0c1\uc5d0 \ub300\ud55c \ubd84\uc11d\uc744 \uc81c\uacf5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c\ub294 \uac04\ub2e8\ud55c Resnet \ubaa8\ub378\uc744 \uc0ac\uc6a9\ud558\uc5ec \ud150\uc11c\ubcf4\ub4dc \ud50c\ub7ec\uadf8\uc778\uc744 \ud65c\uc6a9\ud55c \ubaa8\ub378 \uc131\ub2a5 \ubd84\uc11d \ubc29\ubc95\uc744 \ubcf4\uc5ec\ub4dc\ub9ac\uaca0\uc2b5\ub2c8\ub2e4. \uc900\ube44# \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uc5ec ``torch``\uc640 ``torchvision``\uc744 \uc124\uce58\ud569\ub2c8\ub2e4: pip install torch torchvision \uacfc\uc815# \ub370\uc774\ud130 \ubc0f \ubaa8\ub378 \uc900\ube44 \ud504\ub85c\ud30c\uc77c\ub7ec\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc2e4\ud589 \uc774\ubca4\ud2b8(execution events) \uae30\ub85d \ud504\ub85c\ud30c\uc77c\ub7ec \uc2e4\ud589 \ud150\uc11c\ubcf4\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \uacb0\uacfc \ud655\uc778 \ubc0f \ubaa8\ub378 \uc131\ub2a5 \ubd84\uc11d \ud504\ub85c\ud30c\uc77c\ub7ec\uc758 \ub3c4\uc6c0\uc73c\ub85c \uc131\ub2a5 \uac1c\uc120 \ub2e4\ub978 \uace0\uae09 \uae30\ub2a5\uc73c\ub85c \uc131\ub2a5 \ubd84\uc11d \ucd94\uac00 \uc5f0\uc2b5: AMD GPU\uc5d0\uc11c PyTorch \ud504\ub85c\ud30c\uc77c\ub9c1 1. \ub370\uc774\ud130 \ubc0f \ubaa8\ub378 \uc900\ube44# \uba3c\uc800 \ud544\uc694\ud55c \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \ubaa8\ub450 \ubd88\ub7ec\uc635\ub2c8\ub2e4: import torch import torch.nn import torch.optim import torch.profiler import torch.utils.data import torchvision.datasets import torchvision.models import torchvision.transforms as T \uc774\ud6c4 \uc785\ub825 \ub370\uc774\ud130\ub97c \uc900\ube44\ud569\ub2c8\ub2e4. \uc774 \ud29c\ud1a0\ub9ac\uc5bc\uc758 \uacbd\uc6b0 CIFAR10 \ub370\uc774\ud130\uc14b\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \uc6d0\ud558\ub294 \ud615\uc2dd\uc73c\ub85c \ubcc0\ud658\ud558\uace0 ``DataLoader``\ub97c \uc0ac\uc6a9\ud558\uc5ec \uac01 \ubc30\uce58(batch)\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4. transform = T.Compose( [T.Resize(224), T.ToTensor(), T.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))]) train_set = torchvision.datasets.CIFAR10(root=\u0027./data\u0027, train=True, download=True, transform=transform) train_loader = torch.utils.data.DataLoader(train_set, batch_size=32, shuffle=True) 0%| | 0.00/170M [00:00\u003c?, ?B/s] 0%| | 32.8k/170M [00:00\u003c14:23, 197kB/s] 0%| | 65.5k/170M [00:00\u003c14:23, 197kB/s] 0%| | 98.3k/170M [00:00\u003c14:18, 199kB/s] 0%| | 229k/170M [00:00\u003c06:33, 432kB/s] 0%| | 459k/170M [00:00\u003c03:39, 775kB/s] 1%| | 918k/170M [00:00\u003c01:57, 1.45MB/s] 1%| | 1.84M/170M [00:01\u003c01:00, 2.78MB/s] 2%|\u258f | 3.70M/170M [00:01\u003c00:30, 5.47MB/s] 4%|\u258d | 7.14M/170M [00:01\u003c00:16, 9.93MB/s] 6%|\u258c | 10.0M/170M [00:01\u003c00:13, 12.1MB/s] 8%|\u258a | 13.1M/170M [00:01\u003c00:11, 13.8MB/s] 9%|\u2589 | 16.0M/170M [00:02\u003c00:10, 14.9MB/s] 11%|\u2588 | 18.8M/170M [00:02\u003c00:09, 15.5MB/s] 13%|\u2588\u258e | 21.8M/170M [00:02\u003c00:09, 16.1MB/s] 14%|\u2588\u258d | 24.7M/170M [00:02\u003c00:08, 16.2MB/s] 16%|\u2588\u258b | 27.8M/170M [00:02\u003c00:08, 16.7MB/s] 18%|\u2588\u258a | 30.7M/170M [00:02\u003c00:08, 16.9MB/s] 20%|\u2588\u2589 | 33.7M/170M [00:03\u003c00:07, 17.1MB/s] 22%|\u2588\u2588\u258f | 36.7M/170M [00:03\u003c00:07, 17.2MB/s] 23%|\u2588\u2588\u258e | 39.6M/170M [00:03\u003c00:07, 17.2MB/s] 25%|\u2588\u2588\u258d | 42.4M/170M [00:03\u003c00:07, 17.1MB/s] 27%|\u2588\u2588\u258b | 45.3M/170M [00:03\u003c00:07, 16.5MB/s] 28%|\u2588\u2588\u258a | 48.3M/170M [00:03\u003c00:07, 16.7MB/s] 30%|\u2588\u2588\u2588 | 51.2M/170M [00:04\u003c00:07, 16.8MB/s] 32%|\u2588\u2588\u2588\u258f | 54.1M/170M [00:04\u003c00:06, 16.9MB/s] 33%|\u2588\u2588\u2588\u258e | 57.0M/170M [00:04\u003c00:06, 17.0MB/s] 35%|\u2588\u2588\u2588\u258c | 60.1M/170M [00:04\u003c00:06, 17.2MB/s] 37%|\u2588\u2588\u2588\u258b | 63.0M/170M [00:04\u003c00:06, 17.1MB/s] 39%|\u2588\u2588\u2588\u2589 | 66.1M/170M [00:04\u003c00:06, 17.2MB/s] 41%|\u2588\u2588\u2588\u2588 | 69.2M/170M [00:05\u003c00:05, 17.3MB/s] 42%|\u2588\u2588\u2588\u2588\u258f | 72.2M/170M [00:05\u003c00:05, 17.3MB/s] 44%|\u2588\u2588\u2588\u2588\u258d | 75.2M/170M [00:05\u003c00:05, 17.3MB/s] 46%|\u2588\u2588\u2588\u2588\u258c | 78.0M/170M [00:05\u003c00:05, 17.1MB/s] 47%|\u2588\u2588\u2588\u2588\u258b | 81.0M/170M [00:05\u003c00:05, 17.2MB/s] 49%|\u2588\u2588\u2588\u2588\u2589 | 84.0M/170M [00:05\u003c00:05, 17.2MB/s] 51%|\u2588\u2588\u2588\u2588\u2588 | 87.0M/170M [00:06\u003c00:04, 17.2MB/s] 53%|\u2588\u2588\u2588\u2588\u2588\u258e | 89.9M/170M [00:06\u003c00:04, 17.2MB/s] 54%|\u2588\u2588\u2588\u2588\u2588\u258d | 92.8M/170M [00:06\u003c00:04, 17.2MB/s] 56%|\u2588\u2588\u2588\u2588\u2588\u258c | 95.7M/170M [00:06\u003c00:04, 17.1MB/s] 58%|\u2588\u2588\u2588\u2588\u2588\u258a | 98.5M/170M [00:06\u003c00:04, 17.0MB/s] 59%|\u2588\u2588\u2588\u2588\u2588\u2589 | 101M/170M [00:07\u003c00:04, 17.0MB/s] 61%|\u2588\u2588\u2588\u2588\u2588\u2588 | 104M/170M [00:07\u003c00:03, 17.1MB/s] 63%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 107M/170M [00:07\u003c00:03, 17.0MB/s] 65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 110M/170M [00:07\u003c00:03, 17.2MB/s] 66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 113M/170M [00:07\u003c00:03, 17.2MB/s] 68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 116M/170M [00:07\u003c00:03, 17.1MB/s] 70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 119M/170M [00:08\u003c00:02, 17.1MB/s] 72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 122M/170M [00:08\u003c00:02, 17.1MB/s] 73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 125M/170M [00:08\u003c00:02, 17.2MB/s] 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 128M/170M [00:08\u003c00:02, 17.2MB/s] 77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 131M/170M [00:08\u003c00:02, 17.0MB/s] 78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 134M/170M [00:08\u003c00:02, 17.0MB/s] 80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 137M/170M [00:09\u003c00:01, 17.0MB/s] 82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 140M/170M [00:09\u003c00:01, 17.0MB/s] 84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 143M/170M [00:09\u003c00:01, 17.1MB/s] 85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 146M/170M [00:09\u003c00:01, 17.3MB/s] 87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 148M/170M [00:09\u003c00:01, 17.1MB/s] 89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 151M/170M [00:09\u003c00:01, 17.2MB/s] 91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 154M/170M [00:10\u003c00:00, 17.2MB/s] 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 157M/170M [00:10\u003c00:00, 17.1MB/s] 94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 160M/170M [00:10\u003c00:00, 17.0MB/s] 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 163M/170M [00:10\u003c00:00, 16.9MB/s] 97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 166M/170M [00:10\u003c00:00, 16.9MB/s] 99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 169M/170M [00:10\u003c00:00, 17.0MB/s] 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 170M/170M [00:10\u003c00:00, 15.5MB/s] \uadf8\ub7f0 \ub2e4\uc74c Resnet \ubaa8\ub378, \uc190\uc2e4 \ud568\uc218 \ubc0f \uc635\ud2f0\ub9c8\uc774\uc800 \uac1d\uccb4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. GPU\uc5d0\uc11c \uc2e4\ud589\ud558\uae30 \uc704\ud574 \ubaa8\ub378 \ubc0f \uc190\uc2e4\uc744 GPU \uc7a5\uce58\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4. device = torch.device(\"cuda:0\") model = torchvision.models.resnet18(weights=\u0027IMAGENET1K_V1\u0027).cuda(device) criterion = torch.nn.CrossEntropyLoss().cuda(device) optimizer = torch.optim.SGD(model.parameters(), lr=0.001, momentum=0.9) model.train() ResNet( (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False) (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False) (layer1): Sequential( (0): BasicBlock( (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) (1): BasicBlock( (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (layer2): Sequential( (0): BasicBlock( (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False) (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (downsample): Sequential( (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False) (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (1): BasicBlock( (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (layer3): Sequential( (0): BasicBlock( (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False) (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (downsample): Sequential( (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False) (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (1): BasicBlock( (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (layer4): Sequential( (0): BasicBlock( (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False) (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (downsample): Sequential( (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False) (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (1): BasicBlock( (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (relu): ReLU(inplace=True) (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False) (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) ) ) (avgpool): AdaptiveAvgPool2d(output_size=(1, 1)) (fc): Linear(in_features=512, out_features=1000, bias=True) ) \uac01 \uc785\ub825 \ub370\uc774\ud130 \ubc30\uce58\uc5d0 \ub300\ud55c \ud559\uc2b5 \ub2e8\uacc4\ub97c \uc815\uc758\ud569\ub2c8\ub2e4. def train(data): inputs, labels = data[0].to(device=device), data[1].to(device=device) outputs = model(inputs) loss = criterion(outputs, labels) optimizer.zero_grad() loss.backward() optimizer.step() 2. \ud504\ub85c\ud30c\uc77c\ub7ec\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc2e4\ud589 \uc774\ubca4\ud2b8 \uae30\ub85d# \ud504\ub85c\ud30c\uc77c\ub7ec\ub294 \ucee8\ud14d\uc2a4\ud2b8(context) \uad00\ub9ac\uc790\ub97c \ud1b5\ud574 \ud65c\uc131\ud654\ub418\uace0 \uba87 \uac00\uc9c0 \ub9e4\uac1c\ubcc0\uc218\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc73c\uba70, \uac00\uc7a5 \uc720\uc6a9\ud55c \uac83\uc740 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4: schedule - step (int)\uc744 \ub2e8\uc77c \ub9e4\uac1c\ubcc0\uc218\ub85c \ubc1b\uc544\ub4e4\uc774\uace0, \uac01 \ub2e8\uacc4\uc5d0\uc11c \uc218\ud589\ud560 \ud504\ub85c\ud30c\uc77c\ub7ec \uc791\uc5c5\uc744 \ubc18\ud658\ud558\ub294 \ud638\ucd9c \uac00\ub2a5\ud55c \ud568\uc218\uc785\ub2c8\ub2e4. \uc774 \uc608\uc2dc\uc5d0\uc11c\ub294 wait=1, warmup=1, active=3, repeat=1 \ub85c \uc124\uc815\ub418\uc5b4 \uc788\uc73c\uba70, \ud504\ub85c\ud30c\uc77c\ub7ec\ub294 \uccab \ubc88\uc9f8 \ub2e8\uacc4/\ubc18\ubcf5(step/iteration)\uc744 \uac74\ub108\ub701\ub2c8\ub2e4. \ub450 \ubc88\uc9f8\ubd80\ud130 \uc6cc\ubc0d\uc5c5(warming up)\uc744 \uc2dc\uc791\ud558\uba74, \ub2e4\uc74c \uc138 \ubc88\uc758 \ubc18\ubcf5\uc744 \uae30\ub85d\ud558\uace0, \uadf8 \ud6c4 \ucd94\uc801(trace)\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ub418\uace0 on_trace_ready (\uc124\uc815\ub41c \uacbd\uc6b0)\uac00 \ud638\ucd9c\ub429\ub2c8\ub2e4. \uc804\uccb4\uc801\uc73c\ub85c \uc774 \uc8fc\uae30\uac00 \ud55c \ubc88 \ubc18\ubcf5\ub429\ub2c8\ub2e4. \ud150\uc11c\ubcf4\ub4dc \ud50c\ub7ec\uadf8\uc778\uc5d0\uc11c \uac01 \uc8fc\uae30\ub294 \u201cspan\u201d\uc774\ub77c\uace0 \ud569\ub2c8\ub2e4. wait \ub2e8\uacc4\uc778 \ub3d9\uc548 \ud504\ub85c\ud30c\uc77c\ub7ec\ub294 \ube44\ud65c\uc131\ud654\ub429\ub2c8\ub2e4. warmup \ub2e8\uacc4\uc778 \ub3d9\uc548\uc5d4 \ud504\ub85c\ud30c\uc77c\ub7ec\uac00 \ucd94\uc801(tracing)\uc744 \uc2dc\uc791\ud558\uc9c0\ub9cc \uacb0\uacfc\ub294 \ubb34\uc2dc\ub429\ub2c8\ub2e4. \uc774\ub294 \ud504\ub85c\ud30c\uc77c\ub9c1 \uacfc\ubd80\ud558(overhead)\ub97c \uc904\uc774\uae30 \uc704\ud568\uc785\ub2c8\ub2e4. \ud504\ub85c\ud30c\uc77c\ub9c1\uc744 \uc2dc\uc791\ud560 \ub54c \uacfc\ubd80\ud558\ub294 \ud06c\uace0 \ud504\ub85c\ud30c\uc77c\ub9c1 \uacb0\uacfc\uc5d0 \uc65c\uace1\uc744 \uac00\uc838\uc624\uae30 \uc27d\uc2b5\ub2c8\ub2e4. active \ub2e8\uacc4\uc5d0\uc120 \ud504\ub85c\ud30c\uc77c\ub7ec\uac00 \uc791\ub3d9\ud558\uba70 \uc774\ubca4\ud2b8\ub97c \uae30\ub85d\ud569\ub2c8\ub2e4. on_trace_ready - \uac01 \uc8fc\uae30 \ub9c8\uc9c0\ub9c9\uc5d0 \ud638\ucd9c\ub418\ub294 \ud568\uc218\uc785\ub2c8\ub2e4; \uc774 \uc608\uc2dc\uc5d0\uc11c\ub294 torch.profiler.tensorboard_trace_handler``\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud150\uc11c\ubcf4\ub4dc\uc758 \uacb0\uacfc \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4. \ud504\ub85c\ud30c\uc77c\ub9c1 \ud6c4 \uacb0\uacfc \ud30c\uc77c\uc740 ``./log/resnet18 \ub514\ub809\ud1a0\ub9ac\uc5d0 \uc800\uc7a5\ub429\ub2c8\ub2e4. \ud150\uc11c\ubcf4\ub4dc\uc5d0\uc11c \ud504\ub85c\ud30c\uc77c(profile)\uc744 \ubd84\uc11d\ud558\ub824\uba74 \uc774 \ub514\ub809\ud1a0\ub9ac\ub97c logdir \ub9e4\uac1c\ubcc0\uc218\ub85c \uc9c0\uc815\ud574\uc57c \ud569\ub2c8\ub2e4. record_shapes - \uc5f0\uc0b0\uc790 \uc785\ub825\uc758 shape\uc744 \uae30\ub85d\ud560\uc9c0 \uc5ec\ubd80\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. profile_memory - Track tensor memory \ud560\ub2f9/\ud560\ub2f9 \ud574\uc81c \uc5ec\ubd80\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \uc8fc\uc758, 1.10 \uc774\uc804 \ubc84\uc804\uc758 \ud30c\uc774\ud1a0\uce58\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 \ud504\ub85c\ud30c\uc77c\ub9c1 \uc2dc\uac04\uc774 \uae38\ub2e4\uba74 \uc774 \uae30\ub2a5\uc744 \ube44\ud65c\uc131\ud654\ud558\uac70\ub098 \uc0c8 \ubc84\uc804\uc73c\ub85c \uc5c5\uadf8\ub808\uc774\ub4dc\ud574 \uc8fc\uc138\uc694. with_stack - ops\uc5d0 \ub300\ud55c \uc18c\uc2a4 \uc815\ubcf4(\ud30c\uc77c \ubc0f \ub77c\uc778 \ubc88\ud638)\ub97c \uae30\ub85d \uc5ec\ubd80\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \ub9cc\uc57d VS Code\uc5d0\uc11c \ud150\uc11c\ubcf4\ub4dc\ub97c \uc2e4\ud589\ud558\ub294 \uacbd\uc6b0 (\ucc38\uace0), \uc2a4\ud0dd \ud504\ub808\uc784(stack frame)\uc744 \ud074\ub9ad\ud558\uba74 \ud2b9\uc815 \ucf54\ub4dc \ub77c\uc778\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4. with torch.profiler.profile( schedule=torch.profiler.schedule(wait=1, warmup=1, active=3, repeat=1), on_trace_ready=torch.profiler.tensorboard_trace_handler(\u0027./log/resnet18\u0027), record_shapes=True, profile_memory=True, with_stack=True ) as prof: for step, batch_data in enumerate(train_loader): prof.step() # \uac01 \ub2e8\uacc4\uc5d0\uc11c \ud638\ucd9c\ud558\uc5ec \ud504\ub85c\ud30c\uc77c\ub7ec\uc5d0\uac8c \ub2e8\uacc4\uc758 \uacbd\uacc4\ub97c \uc54c\ub824\uc57c \ud569\ub2c8\ub2e4. if step \u003e= 1 + 1 + 3: break train(batch_data) \ub610\ud55c, \ub2e4\uc74c\uc758 non-context \uad00\ub9ac\uc790(manager)\ub294 \uc2dc\uc791(start)/\uc815\uc9c0(stop) \uae30\ub2a5\ub3c4 \uc9c0\uc6d0\ub429\ub2c8\ub2e4. prof = torch.profiler.profile( schedule=torch.profiler.schedule(wait=1, warmup=1, active=3, repeat=1), on_trace_ready=torch.profiler.tensorboard_trace_handler(\u0027./log/resnet18\u0027), record_shapes=True, with_stack=True) prof.start() for step, batch_data in enumerate(train_loader): prof.step() if step \u003e= 1 + 1 + 3: break train(batch_data) prof.stop() 3. \ud504\ub85c\ud30c\uc77c\ub7ec \uc2e4\ud589# \uc704 \ucf54\ub4dc\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4. \ud504\ub85c\ud30c\uc77c\ub9c1 \uacb0\uacfc\ub294 ./log/resnet18 \ub514\ub809\ud1a0\ub9ac\uc5d0 \uc800\uc7a5\ub429\ub2c8\ub2e4. 4. \ud150\uc11c\ubcf4\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \uacb0\uacfc \ud655\uc778 \ubc0f \ubaa8\ub378 \uc131\ub2a5 \ubd84\uc11d# \ucc38\uace0 \ud150\uc11c\ubcf4\ub4dc \ud50c\ub7ec\uadf8\uc778(Tensorboard Plugin) \uc9c0\uc6d0\uc774 \uc911\ub2e8\ub418\uc5c8\uc73c\ubbc0\ub85c, \uc544\ub798 \uae30\ub2a5\ub4e4 \uc911 \uc77c\ubd80\ub294 \uc774\uc804\ucc98\ub7fc \ub3d9\uc791\ud558\uc9c0 \uc54a\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774\uc5d0 \ub300\ud55c \ub300\uc548\uc73c\ub85c HTA \ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud30c\uc774\ud1a0\uce58 \ud504\ub85c\ud30c\uc77c\ub7ec \ud150\uc11c\ubcf4\ub4dc \ud50c\ub7ec\uadf8\uc778\uc744 \uc124\uce58\ud569\ub2c8\ub2e4. pip install torch_tb_profiler \ud150\uc11c\ubcf4\ub4dc\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4. tensorboard --logdir=./log \uad6c\uae00 \ud06c\ub86c(Google Chrome) \ube0c\ub77c\uc6b0\uc800 \ub610\ub294 \ub9c8\uc774\ud06c\ub85c\uc18c\ud504\ud2b8 \uc5e3\uc9c0(Microsoft Edge) \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \ud150\uc11c\ubcf4\ub4dc \ud504\ub85c\ud30c\uc77c(profile) URL\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4. (Safari \ube0c\ub77c\uc6b0\uc800\ub294 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.) http://localhost:6006/#pytorch_profiler \uc544\ub798\uc640 \uac19\uc774 \ud504\ub85c\ud30c\uc77c\ub7ec \ud50c\ub7ec\uadf8\uc778 \ud398\uc774\uc9c0\ub97c \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uac1c\uc694(Overview) \uac1c\uc694 \ud398\uc774\uc9c0\uc5d0\ub294 \ubaa8\ub378 \uc131\ub2a5\uc5d0 \ub300\ud55c \ub300\ub7b5\uc801\uc778 \uc694\uc57d\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4. \u201cGPU \uc694\uc57d(GPU Summary)\u201d \ud328\ub110\uc5d0\ub294 GPU \uad6c\uc131, GPU \uc0ac\uc6a9\ub7c9 \ubc0f Tensor \ucf54\uc5b4 \uc0ac\uc6a9\ub7c9\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4. \uc774 \uc608\uc81c\uc5d0\uc11c\ub294 GPU \uc0ac\uc6a9\ub7c9\uc774 \ub0ae\uc2b5\ub2c8\ub2e4. \uc774\ub7ec\ud55c \uce21\uc815 \uc9c0\ud45c(metrics)\uc5d0 \ub300\ud55c \uc790\uc138\ud55c \ub0b4\uc6a9\uc740 \uc5ec\uae30 \uc5d0\uc11c \ud655\uc778\ud574\uc8fc\uc138\uc694. \u201c\ub2e8\uacc4 \uc2dc\uac04 \uc138\ubd84\ud654(Step Time Breakdown)\u201d\ub294 \uac01 \ub2e8\uacc4\uc5d0\uc11c \uc218\ud589\ub41c \uc2dc\uac04\uc758 \ubd84\ud3ec\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc774 \uc608\uc81c\uc5d0\uc11c\ub294 DataLoader \uacfc\ubd80\ud558\uac00 \uc0c1\ub2f9\ud55c \uac83\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud558\ub2e8\uc758 \u201c\uc131\ub2a5 \uad8c\uc7a5\uc0ac\ud56d(Performance Recommendation)\u201d\uc740 \ud504\ub85c\ud30c\uc77c\ub9c1 \ub370\uc774\ud130\ub97c \uc0ac\uc6a9\ud558\uc5ec \ubc1c\uc0dd \uac00\ub2a5\ud55c \ubcd1\ubaa9 \ud604\uc0c1\uc744 \uc790\ub3d9\uc73c\ub85c \uac15\uc870\ud558\uace0, \uc2e4\ud589 \uac00\ub2a5\ud55c \ucd5c\uc801\ud654 \uc81c\uc548\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. \uc67c\ucabd \u201c\ubcf4\uae30(Views)\u201d \ub4dc\ub86d\ub2e4\uc6b4(dropdown) \ubaa9\ub85d\uc5d0\uc11c \ubcf4\uae30 \ud398\uc774\uc9c0\ub97c \ubcc0\uacbd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc5f0\uc0b0 \ubcf4\uae30(Operator view) \uc5f0\uc0b0 \ubcf4\uae30\ub294 \ud638\uc2a4\ud2b8 \ub610\ub294 \uc7a5\uce58\uc5d0\uc11c \uc2e4\ud589\ub418\ub294 \ubaa8\ub4e0 \ud30c\uc774\ud1a0\uce58 \uc5f0\uc0b0\uc790\uc758 \uc131\ub2a5\uc744 \ud45c\uc2dc\ud569\ub2c8\ub2e4. \u201c\uc140\ud504(Self)\u201d \uae30\uac04\uc5d0\ub294 \ud558\uc704 \uc5f0\uc0b0\uc758 \uc2dc\uac04\uc774 \ud3ec\ud568\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \u201c\uc804\uccb4(Total)\u201d \uae30\uac04\uc5d0\ub294 \ud558\uc704 \uc5f0\uc0b0\uc758 \uc2dc\uac04\uc774 \ud3ec\ud568\ub429\ub2c8\ub2e4. \ud638\ucd9c \uc2a4\ud0dd \ubcf4\uae30(View call stack) \uc5f0\uc0b0\uc790\uc758 ``View Callstack``\ub97c \ud074\ub9ad\ud558\uba74, \uc774\ub984\uc740 \uac19\uc9c0\ub9cc \uc11c\ub85c \ub2e4\ub978 \uc5f0\uc0b0\uc790\uac00 \ud45c\uc2dc\ub429\ub2c8\ub2e4. \ud558\uc704 \ud14c\uc774\ube14\uc758 ``View Callstack``\ub97c \ud074\ub9ad\ud558\uba74, \ud638\ucd9c \uc2a4\ud0dd \ud504\ub808\uc784(call stack frames)\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4. VS Code \ub0b4\ubd80\uc5d0\uc11c \ud150\uc11c\ubcf4\ub4dc\uac00 \uc2e4\ud589\ub418\ub294 \uacbd\uc6b0 (\uc2e4\ud589 \uac00\uc774\ub4dc), \ud638\ucd9c \uc2a4\ud0dd \ud504\ub808\uc784(call stack frame)\uc744 \ud074\ub9ad\ud558\uba74 \ud2b9\uc815 \ucf54\ub4dc \ub77c\uc778\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4. \ucee4\ub110 \ubcf4\uae30(Kernel view) GPU \ucee4\ub110 \ubcf4\uae30(GPU kernel view)\ub294 \ubaa8\ub4e0 \ucee4\ub110(kernel)\uc774 GPU\uc5d0 \uc18c\ube44\ud55c \uc2dc\uac04\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc0ac\uc6a9\ub41c Tensor \ucf54\uc5b4: \uc774 \ucee4\ub110(kernel)\uc774 tensor \ucf54\uc5b4\ub97c \uc0ac\uc6a9\ud558\ub294\uc9c0 \uc5ec\ubd80\ub8f0 \ub098\ud0c0\ub0c5\ub2c8\ub2e4. SM\ub2f9 \ud3c9\uade0 \ube14\ub7ed \uc218: SM\ub2f9 \ube14\ub7ed \uc218 = \ucee4\ub110(kernel)\uc758 \ube14\ub7ed / GPU\uc758 SM \uc218. \uc774 \uc218\uce58\uac00 1\ubcf4\ub2e4 \uc791\uc73c\uba74 GPU \uba40\ud2f0\ud504\ub85c\uc138\uc11c\uac00 \uc644\uc804\ud788 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\uc74c\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \u201cSM\ub2f9 \ud3c9\uade0 \ube14\ub7ed \uc218(Mean Blocks per SM)\u201d\ub294 \uc774 \ucee4\ub110 \uc774\ub984\uc758 \ubaa8\ub4e0 \uc2e4\ud589\uc5d0 \ub300\ud55c \uac00\uc911 \ud3c9\uade0\uc774\uace0, \uac01 \uc2e4\ud589 \uae30\uac04\uc744 \uac00\uc911\uce58\ub85c \uc0ac\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4. \ud3c9\uade0 \uc608\uc0c1 \ub2ec\uc131 \uc810\uc720\uc728(Mean Est. Achieved Occupancy): \uc608\uc0c1 \ub2ec\uc131 \uc810\uc720\uc728(Est. Achieved Occupancy)\uc740 \uc5f4\uc758 \ud234\ud301(column\u2019s tooltip)\uc5d0 \uc815\uc758\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \ub300\uc5ed\ud3ed \uacbd\uacc4 \ucee4\ub110\uacfc \uac19\uc740 \ub300\ubd80\ubd84\uc758 \uacbd\uc6b0, \ub192\uc744\uc218\ub85d \uc88b\uc2b5\ub2c8\ub2e4. \u201c\ud3c9\uade0 \uc608\uc0c1 \ub2ec\uc131 \uc810\uc720\uc728(Mean Est. Achieved Occupancy)\u201d\uc740 \ucee4\ub110 \uc774\ub984\uc758 \ubaa8\ub4e0 \uc2e4\ud589\uc5d0 \ub300\ud55c \uac00\uc911 \ud3c9\uade0\uc774\uba70, \uac01 \uc2e4\ud589\uc758 \uc9c0\uc18d \uc2dc\uac04\uc744 \uac00\uc911\uce58\ub85c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \ucd94\uc801 \ubcf4\uae30(Trace view) \ucd94\uc801 \ubcf4\uae30\ub294 \ud504\ub85c\ud30c\uc77c\ub41c \uc5f0\uc0b0\uc790\uc640 GPU \ucee4\ub110\uc758 \ud0c0\uc784\ub77c\uc778\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc544\ub798\uc640 \uac19\uc774 \uc120\ud0dd\ud558\uc5ec \uc138\ubd80 \uc815\ubcf4\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc624\ub978\ucabd \ub3c4\uad6c \ubaa8\uc74c\uc744 \uc0ac\uc6a9\ud558\uc5ec \uadf8\ub798\ud504\ub97c \uc774\ub3d9\ud558\uace0 \ud655\ub300/\ucd95\uc18c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub610\ud55c \ud0a4\ubcf4\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud0c0\uc784\ub77c\uc778 \uc548\uc5d0\uc11c \ud655\ub300/\uc774\ub3d9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \u2018w\u2019\ubc0f \u2018s\u2019 \ud0a4\ub294 \ub9c8\uc6b0\uc2a4 \uc911\uc2ec\uc73c\ub85c \ud655\ub300\ub418\uba70, \u2018a\u2019\uc640 \u2018d\u2019 \ud0a4\ub294 \ud0c0\uc784\ub77c\uc778\uc744 \uc88c\uc6b0\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4. \uc77d\uc744 \uc218 \uc788\ub294 \ud45c\ud604\uc774 \ubcf4\uc77c \ub54c\uae4c\uc9c0 \uc774 \ud0a4\ub97c \uc5ec\ub7ec \ubc88 \ub204\ub97c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc5ed\ubc29\ud5a5 \uc5f0\uc0b0\uc790(backward operator)\uc758 \u201cIncoming Flow\u201d \ud544\ub4dc\uac00 \u201cforward correspond to backward\u201d \uac12\uc778 \uacbd\uc6b0, \ud14d\uc2a4\ud2b8\ub97c \ud074\ub9ad\ud558\uc5ec \uc2dc\uc791\ub418\ub294 \uc804\uc9c4 \uc5f0\uc0b0\uc790(forward operator)\ub97c \uac00\uc838\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \uc608\uc2dc\uc5d0\uc11c\ub294 ``enumerate(DataLoader)``\ub85c \uc811\ub450\uc0ac\uac00 \ubd99\uc740 \uc774\ubca4\ud2b8\uc5d0 \ub9ce\uc740 \uc2dc\uac04\uc774 \uc18c\uc694\ub418\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uadf8\ub9ac\uace0 \ub300\ubd80\ubd84\uc758 \uae30\uac04 \ub3d9\uc548 GPU\ub294 \uc26c\ub294 \uc0c1\ud0dc\uc785\ub2c8\ub2e4. \uc774 \uae30\ub2a5\uc740 \ud638\uc2a4\ud2b8 \uce21\uc5d0\uc11c \ub370\uc774\ud130\ub97c \ub85c\ub4dc\ud558\uace0 \ub370\uc774\ud130\ub97c \ubcc0\ud658\ud558\ub294 \uae30\ub2a5\uc774\uae30 \ub54c\ubb38\uc5d0, GPU \ub9ac\uc18c\uc2a4\uac00 \ub0ad\ube44\ub429\ub2c8\ub2e4. 5. \ud504\ub85c\ud30c\uc77c\ub7ec\uc758 \ub3c4\uc6c0\uc73c\ub85c \uc131\ub2a5 \uac1c\uc120# \u201c\uac1c\uc694(Overview)\u201d \ud398\uc774\uc9c0 \ud558\ub2e8\uc758 \u201c\uc131\ub2a5 \ucd94\ucc9c(Performance Recommendation)\u201d \uc81c\uc548\uc740 \ubcd1\ubaa9 \ud604\uc0c1\uc774 \u201c ``DataLoader``\uc784\uc744 \uc554\uc2dc\ud569\ub2c8\ub2e4. \ud30c\uc774\ud1a0\uce58 ``DataLoader``\ub294 \uae30\ubcf8\uc801\uc73c\ub85c \ub2e8\uc77c \ud504\ub85c\uc138\uc2a4\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \uc0ac\uc6a9\uc790\ub294 \ub9e4\uac1c\ubcc0\uc218 ``num_workers``\ub97c \uc124\uc815\ud558\uc5ec \ub2e4\uc911 \ud504\ub85c\uc138\uc2a4 \ub370\uc774\ud130 \ub85c\ub4dc\ub97c \ud65c\uc131\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc790\uc138\ud55c \ub0b4\uc6a9\uc740 \uc5ec\uae30 \uc5d0 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \uc608\uc2dc\uc5d0\uc11c \u201c\uc131\ub2a5 \uad8c\uc7a5\uc0ac\ud56d(Performance Recommendation)\u201d\uc5d0 \ub530\ub77c \uc544\ub798\uc640 \uac19\uc774 ``num_workers``\ub97c \uc124\uc815\ud558\uace0, ``./log/resnet18_4workers``\uc640 \uac19\uc740 \ub2e4\ub978 \uc774\ub984\uc744 ``tensorboard_trace_handler``\ub85c \uc804\ub2ec\ud55c \ud6c4 \ub2e4\uc2dc \uc2e4\ud589\ud569\ub2c8\ub2e4. train_loader = torch.utils.data.DataLoader(train_set, batch_size=32, shuffle=True, num_workers=4) \uadf8\ub7f0 \ub2e4\uc74c \uc67c\ucabd \u201c\uc2e4\ud589(Runs)\u201d \ub4dc\ub86d\ub2e4\uc6b4(dropdown) \ubaa9\ub85d\uc5d0\uc11c \ucd5c\uadfc \ud504\ub85c\ud30c\uc77c\ub41c \uc2e4\ud589\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4. \uc704\uc758 \ubcf4\uae30(view)\uc5d0\uc11c \uc774\uc804 \uc2e4\ud589\uc778 132ms\uc5d0 \ube44\ud574 \ub2e8\uacc4(step) \uc2dc\uac04\uc774 \uc57d 76ms\ub85c \uac10\uc18c\ud558\uace0, ``DataLoader``\uc758 \uc2dc\uac04 \uac10\uc18c\uac00 \uc8fc\ub85c \uae30\uc5ec\ud55c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc704\uc758 \ubcf4\uae30(view)\uc5d0\uc11c ``enumerate(DataLoader)``\uc758 \ub7f0\ud0c0\uc784\uc774 \uac10\uc18c\ud558\uace0, GPU \ud65c\uc6a9\ub3c4\uac00 \uc99d\uac00\ud558\ub294 \uac83\uc744 \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4. 6. \ub2e4\ub978 \uace0\uae09 \uae30\ub2a5\uc73c\ub85c \uc131\ub2a5 \ubd84\uc11d# \uba54\ubaa8\ub9ac \ubcf4\uae30(Memory view) \uba54\ubaa8\ub9ac \ud504\ub85c\ud30c\uc77c\uc744 \uc124\uc815\ud558\ub824\uba74 torch.profiler.profile \uc778\uc218\uc5d0\uc11c ``profile_memory``\ub97c ``True``\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4. Azure\uc758 \uae30\uc874 \uc608\uc81c\ub97c \uc0ac\uc6a9\ud574 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4. pip install azure-storage-blob tensorboard --logdir=https://torchtbprofiler.blob.core.windows.net/torchtbprofiler/demo/memory_demo_1_10 \ud504\ub85c\ud30c\uc77c\ub7ec\ub294 \ud504\ub85c\ud30c\uc77c\ub9c1 \uc911\uc5d0 \ubaa8\ub4e0 \uba54\ubaa8\ub9ac \ud560\ub2f9/\ud574\uc81c \uc774\ubca4\ud2b8\uc640 \ud560\ub2f9\uc790\uc758 \ub0b4\ubd80 \uc0c1\ud0dc\ub97c \uae30\ub85d\ud569\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \ubcf4\uae30(memory view)\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc138 \uac00\uc9c0 \uc694\uc18c\ub85c \uad6c\uc131\ub429\ub2c8\ub2e4. \uad6c\uc131 \uc694\uc18c\ub294 \uac01\uac01 \uba54\ubaa8\ub9ac \uace1\uc120 \uadf8\ub798\ud504, \uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8 \ud14c\uc774\ube14 \ubc0f \uba54\ubaa8\ub9ac \ud1b5\uacc4 \ud14c\uc774\ube14\uc785\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \uc720\ud615\uc740 \u201c\uc7a5\uce58(Device)\u201d \uc120\ud0dd \uc0c1\uc790\uc5d0\uc11c \uc120\ud0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uba74, \ub2e4\uc74c \ud45c\uc5d0\uc11c \u201cGPU0\u201d\uc740 GPU 0\uc5d0\uc11c\uc758 \uac01 \uc5f0\uc0b0\uc790\uc758 \uba54\ub85c\ub9ac \uc0ac\uc6a9\ub7c9\ub9cc \ubcf4\uc5ec\uc8fc\uace0, CPU \ub610\ub294 \ub2e4\ub978 GPU\ub97c \ud3ec\ud568\ud558\uc9c0 \uc54a\ub294\ub2e4\ub294 \uac83\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \uace1\uc120\uc740 \uba54\ubaa8\ub9ac \uc18c\ube44\uc758 \ucd94\uc138\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \u201cAllocated\u201d \uace1\uc120\uc740 \uc2e4\uc81c \uc0ac\uc6a9 \uc911\uc778 \ucd1d \uba54\ubaa8\ub9ac, \uc608\ub97c \ub4e4\uba74 tensor\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \ud30c\uc774\ud1a0\uce58\uc5d0\uc11c \uce90\uc2f1 \uba54\ucee4\ub2c8\uc998(caching mechanism)\uc740 CUDA \ud560\ub2f9\uae30 \ubc0f \uc77c\ubd80 \ub2e4\ub978 \ud560\ub2f9\uae30\uc5d0 \uc0ac\uc6a9\ub429\ub2c8\ub2e4. \u201cReserved\u201d \uace1\uc120\uc740 \ud560\ub2f9\uc790\uc5d0 \uc758\ud574 \uc608\uc57d\ub41c \ucd1d \uba54\ubaa8\ub9ac\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uadf8\ub798\ud504\ub97c \uc88c\ud074\ub9ad\ud558\uace0 \ub04c\uc5b4\uc11c \uc6d0\ud558\ub294 \ubc94\uc704\uc758 \uc774\ubca4\ud2b8\ub97c \uc120\ud0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4: \uc120\ud0dd\ud55c \ud6c4\uc5d0\ub294 \uc138 \uac00\uc9c0 \uad6c\uc131 \uc694\uc18c\uac00 \uc81c\ud55c\ub41c \ubc94\uc704\uc5d0 \ub9de\uac8c \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4 \uc790\uc138\ud55c \uc815\ubcf4\ub97c \uc5bb\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ud504\ub85c\uc138\uc2a4\ub97c \ubc18\ubcf5\ud558\uba74, \ub9e4\uc6b0 \uc138\ubd84\ud654\ub41c \uc138\ubd80 \uc815\ubcf4\ub97c \ud655\ub300\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uadf8\ub798\ud504\ub97c \uc6b0\ud074\ub9ad\ud558\uba74 \uadf8\ub798\ud504\uac00 \ucd08\uae30 \uc0c1\ud0dc\ub85c \uc7ac\uc124\uc815\ub429\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8 \ud14c\uc774\ube14\uc5d0\uc11c \ud560\ub2f9 \ubc0f \ud574\uc81c \uc774\ubca4\ud2b8\ub294 \ud558\ub098\uc758 \ud56d\ubaa9\uc73c\ub85c \uc30d\uc73c\ub85c \uad6c\uc131\ub429\ub2c8\ub2e4. \u201coperator\u201d \uc5f4\uc5d0\ub294 \ud560\ub2f9\uc744 \ubc1c\uc0dd\uc2dc\ud0a4\ub294 \uc989\uc2dc ATen \uc5f0\uc0b0\uc790\uac00 \ud45c\uc2dc\ub429\ub2c8\ub2e4. \ud30c\uc774\ud1a0\uce58\uc5d0\uc11c ATen \uc5f0\uc0b0\uc790\ub294 \uc77c\ubc18\uc801\uc73c\ub85c aten::empty``\ub97c \uc0ac\uc6a9\ud558\uc5ec \uba54\ubaa8\ub9ac\ub97c \ud560\ub2f9\ud569\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, ``aten::ones``\uc740 ``aten::empty \ub2e4\uc74c\uc5d0 ``aten::fill_``\ub85c \uad6c\ud604\ub429\ub2c8\ub2e4. \uc5f0\uc0b0\uc790 \uc774\ub984\ub9cc ``aten::empty``\ub85c \ud45c\uc2dc\ud574\ub3c4 \ubcc4 \ub3c4\uc6c0\uc774 \ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uc774 \ud2b9\uc218\ud55c \uacbd\uc6b0\uc5d0\ub294 ``aten::ones (aten::empty)``\ub85c \ud45c\uc2dc\ub429\ub2c8\ub2e4. \u201c\ud560\ub2f9 \uc2dc\uac04(Allocation Time)\u201d, \u201c\ud574\uc81c \uc2dc\uac04(Release Time)\u201d \ubc0f \u201c\uae30\uac04(Duration)\u201d\uc740 \uc774\ubca4\ud2b8\uac00 \uc2dc\uac04 \ubc94\uc704\ub97c \ubc97\uc5b4\ub098\ub294 \uacbd\uc6b0 \uc5f4\uc758 \ub370\uc774\ud130\uac00 \ub204\ub77d\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uba54\ubaa8\ub9ac \ud1b5\uacc4 \ud14c\uc774\ube14\uc5d0\uc11c, \u201c\ud06c\uae30 \uc99d\uac00(Size Increase)\u201d \uc5f4\uc740 \ubaa8\ub4e0 \ud560\ub2f9 \ud06c\uae30\ub97c \ud569\uc0b0\ud558\uace0 \ubaa8\ub4e0 \uba54\ubaa8\ub9ac \ub9b4\ub9ac\uc2a4(release) \ud06c\uae30\ub97c \ube80 \uac12, \uc989, \uc774 \uc5f0\uc0b0\uc790 \uc774\ud6c4\uc758 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9 \uc21c \uc99d\uac00 \uac12\uc785\ub2c8\ub2e4. \u201c\uc790\uccb4 \ud06c\uae30 \uc99d\uac00(Self Size Increase)\u201d \uc5f4\uc740 \u201c\ud06c\uae30 \uc99d\uac00(Size Increase)\u201d\uc640 \uc720\uc0ac \ud558\uc9c0\ub9cc, \ud558\uc704 \uc5f0\uc0b0\uc790\uc758 \ud560\ub2f9\uc740 \uacc4\uc0b0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. ATen \uc5f0\uc0b0\uc790\uc758 \uad6c\ud604 \uc138\ubd80 \uc0ac\ud56d\uacfc \uad00\ub828\ud558\uc5ec, \uc77c\ubd80 \uc5f0\uc0b0\uc790\ub294 \ub2e4\ub978 \uc5f0\uc0b0\uc790\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\uc73c\ubbc0\ub85c, \uba54\ubaa8\ub9ac \ud560\ub2f9\uc740 \ucf5c \uc2a4\ud0dd\uc758 \ubaa8\ub4e0 \uc218\uc900\uc5d0\uc11c \ubc1c\uc0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc989, \u201c\uc790\uccb4 \ud06c\uae30 \uc99d\uac00(Self Size Increase)\u201d\ub294 \ud604\uc7ac \uc218\uc900\uc758 \ucf5c \uc2a4\ud0dd\uc5d0\uc11c \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9 \uc99d\uac00\ub9cc\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c, \u201c\ud560\ub2f9 \ud06c\uae30(Allocation Size)\u201d \uc5f4\uc740 \uba54\ubaa8\ub9ac \ub9b4\ub9ac\uc2a4\ub97c \uace0\ub824\ud558\uc9c0 \uc54a\uace0 \ubaa8\ub4e0 \ud560\ub2f9\uc744 \ud569\uc0b0\ud569\ub2c8\ub2e4. \ubd84\uc0b0 \ubcf4\uae30(Distributed view) \uc774\uc81c \ud50c\ub7ec\uadf8\uc778\uc740 NCCL/GLOO\ub97c \ubc31\uc5d4\ub4dc\ub85c \uc0ac\uc6a9\ud558\ub294 DDP \ud504\ub85c\ud30c\uc77c\ub9c1\uc5d0 \ub300\ud55c \ubd84\uc0b0 \ubcf4\uae30\ub97c \uc9c0\uc6d0\ud569\ub2c8\ub2e4. Azure\uc758 \uae30\uc874 \uc608\uc81c\ub97c \uc0ac\uc6a9\ud574 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4: pip install azure-storage-blob tensorboard --logdir=https://torchtbprofiler.blob.core.windows.net/torchtbprofiler/demo/distributed_bert \u201c\ucef4\ud4e8\ud305/\ucee4\ubba4\ub2c8\ucf00\uc774\uc158 \uac1c\uc694(Computation/Communication Overview)\u201d\uc5d0\ub294 \ucef4\ud4e8\ud305/\ucee4\ubba4\ub2c8\ucf00\uc774\uc158 \ube44\uc728\uacfc \uc911\ubcf5 \uc815\ub3c4\uac00 \ud45c\uc2dc\ub429\ub2c8\ub2e4. \uc774 \ubcf4\uae30\uc5d0\uc11c, \uc0ac\uc6a9\uc790\ub294 \uc791\uc5c5\uc790 \uac04\uc758 \ub85c\ub4dc \ubc38\ub7f0\uc2f1 \ubb38\uc81c\ub97c \ud30c\uc545\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \ud55c \uc791\uc5c5\uc790\uc758 \uc5f0\uc0b0 + \uc911\ubcf5 \uc2dc\uac04\uc774 \ub2e4\ub978 \uc791\uc5c5\uc790\ubcf4\ub2e4 \ud6e8\uc52c \ud070 \uacbd\uc6b0, \ub85c\ub4dc \ubc38\ub7f0\uc2f1\uc5d0 \ubb38\uc81c\uac00 \uc788\uac70\ub098 \uc774 \uc791\uc5c5\uc790\uac00 \ub099\uc624\uc790(straggler)\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \u201c\ub3d9\uae30\ud654/\ucee4\ubba4\ub2c8\ucf00\uc774\uc158 \uac1c\uc694(Synchronizing/Communication Overview)\u201d\ub294 \ud1b5\uc2e0\uc758 \ud6a8\uc728\uc131\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \u201c\ub370\uc774\ud130 \uad50\ud658 \uc2dc\uac04(Data Transfer Time)\u201d\uc740 \uc2e4\uc81c \ub370\uc774\ud130\ub97c \uad50\ud658\ud558\ub294 \uc2dc\uac04\uc785\ub2c8\ub2e4. \u201c\ub3d9\uae30\ud654 \uc2dc\uac04(Synchronizing Time)\u201d\uc740 \ub2e4\ub978 \uc791\uc5c5\uc790\uc640 \ub300\uae30 \ubc0f \ub3d9\uae30\ud654\ud558\ub294 \uc2dc\uac04\uc785\ub2c8\ub2e4. \ud55c \uc791\uc5c5\uc790\uc758 \u201c\ub3d9\uae30\ud654 \uc2dc\uac04\u201d\uc774 \ub2e4\ub978 \uc791\uc5c5\uc790 \ubcf4\ub2e4 \ud6e8\uc52c \uc9e7\ub2e4\uba74\u2019, \uc774 \uc791\uc5c5\uc790\ub294 \ub2e4\ub978 \uc791\uc5c5\uc790\ubcf4\ub2e4 \ub354 \ub9ce\uc740 \uacc4\uc0b0 \uc791\uc5c5\ub7c9\uc744 \uac00\uc9c8 \uc218 \uc788\ub294 \ub099\uc624\uc790(straggler)\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4\u2019. \u201c\ucee4\ubba4\ub2c8\ucf00\uc774\uc158 \uc791\uc5c5 \ud1b5\uacc4(Communication Operations Stats)\u201d\ub294 \uac01 \uc791\uc5c5\uc790\uc758 \ubaa8\ub4e0 \ud1b5\uc2e0 \uc791\uc5c5\uc5d0 \ub300\ud55c \uc138\ubd80 \ud1b5\uacc4\ub97c \uc694\uc57d\ud569\ub2c8\ub2e4. 7. \ucd94\uac00 \uc5f0\uc2b5: AMD GPU\uc5d0\uc11c PyTorch \ud504\ub85c\ud30c\uc77c\ub9c1# The AMD ROCm Platform is an open-source software stack designed for GPU computation, consisting of drivers, development tools, and APIs. We can run the above mentioned steps on AMD GPUs. In this section, we will use Docker to install the ROCm base development image before installing PyTorch. For the purpose of example, let\u2019s create a directory called profiler_tutorial, and save the code in Step 1 as test_cifar10.py in this directory. mkdir ~/profiler_tutorial cd profiler_tutorial vi test_cifar10.py At the time of this writing, the Stable(2.1.1) Linux version of PyTorch on ROCm Platform is ROCm 5.6. Obtain a base Docker image with the correct user-space ROCm version installed from Docker Hub. It is rocm/dev-ubuntu-20.04:5.6. Start the ROCm base Docker container: docker run -it --network=host --device=/dev/kfd --device=/dev/dri --group-add=video --ipc=host --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --shm-size 8G -v ~/profiler_tutorial:/profiler_tutorial rocm/dev-ubuntu-20.04:5.6 Inside the container, install any dependencies needed for installing the wheels package. sudo apt update sudo apt install libjpeg-dev python3-dev -y pip3 install wheel setuptools sudo apt install python-is-python3 Install the wheels: pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/rocm5.6 Install the torch_tb_profiler, and then, run the Python file test_cifar10.py: pip install torch_tb_profiler cd /profiler_tutorial python test_cifar10.py Now, we have all the data needed to view in TensorBoard: tensorboard --logdir=./log Choose different views as described in Step 4. For example, below is the Operator View: At the time this section is written, Trace view does not work and it displays nothing. You can work around by typing chrome://tracing in your Chrome Browser. Copy the trace.json file under ~/profiler_tutorial/log/resnet18 directory to the Windows. You may need to copy the file by using scp if the file is located in a remote location. Click Load button to load the trace JSON file from the chrome://tracing page in the browser. As mentioned previously, you can move the graph and zoom in and out. You can also use keyboard to zoom and move around inside the timeline. The w and s keys zoom in centered around the mouse, and the a and d keys move the timeline left and right. You can hit these keys multiple times until you see a readable representation. \ub354 \uc54c\uc544\ubcf4\uae30# \ud559\uc2b5\uc744 \uacc4\uc18d\ud558\ub824\uba74 \ub2e4\uc74c \ubb38\uc11c\ub97c \ucc38\uc870\ud558\uc2dc\uace0, \uc5ec\uae30 \uc5d0\uc11c \uc790\uc720\ub86d\uac8c \uc774\uc288\ub97c \uc5f4\uc5b4\ubcf4\uc138\uc694. PyTorch TensorBoard Profiler Github torch.profiler API HTA Total running time of the script: (0 minutes 19.780 seconds) Download Jupyter notebook: tensorboard_profiler_tutorial.ipynb Download Python source code: tensorboard_profiler_tutorial.py Download zipped: tensorboard_profiler_tutorial.zip",
       "author": {
         "@type": "Organization",
         "name": "PyTorch Contributors",
         "url": "https://pytorch.org"
       },
       "image": "../_static/img/pytorch_seo.png",
       "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "/intermediate/tensorboard_profiler_tutorial.html"
       },
       "datePublished": "2023-01-01T00:00:00Z",
       "dateModified": "2023-01-01T00:00:00Z"
     }
 </script>
  <script>
    // Tutorials Call to action event tracking
    $("[data-behavior='call-to-action-event']").on('click', function () {
      fbq('trackCustom', "Download", {
        tutorialTitle: $('h1:first').text(),
        downloadLink: this.href,
        tutorialLink: window.location.href,
        downloadTitle: $(this).attr("data-response")
      });
      if (typeof gtag === 'function') {
        gtag('event', 'click', {
          'event_category': $(this).attr("data-response"),
          'event_label': $("h1").first().text(),
          'tutorial_link': window.location.href
        });
      }
    });
  </script>
  
  </body>
</html>